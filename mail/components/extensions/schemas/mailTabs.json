[
  {
    "namespace": "manifest",
    "types": [
      {
        "$extend": "OptionalPermission",
        "choices": [
          {
            "type": "string",
            "enum": [
              "mailTabs"
            ]
          }
        ]
      }
    ]
  },
  {
    "namespace": "mailTabs",
    "permissions": [
      "mailTabs"
    ],
    "types": [
      {
        "id": "QuickFilterTagsDetail",
        "type": "object",
        "properties": {
          "tags": {
            "type": "object",
            "description": "Object keys are tags to filter on, values are <code>true</code> if the message must have the tag, or <code>false</code> if it must not have the tag. For a list of available tags, call the :ref:`messages.listTags` method.",
            "patternProperties": {
              ".*": {
                "type": "boolean"
              }
            }
          },
          "mode": {
            "type": "string",
            "description": "Whether all of the tag filters must apply, or any of them.",
            "enum": [
              "all",
              "any"
            ]
          }
        }
      },
      {
        "id": "QuickFilterTextDetail",
        "type": "object",
        "properties": {
          "text": {
            "type": "string",
            "description": "String to match against the <var>recipients</var>, <var>sender</var>, <var>subject</var>, or <var>body</var>."
          },
          "recipients": {
            "type": "boolean",
            "description": "Shows messages where <var>text</var> matches the recipients.",
            "optional": true
          },
          "sender": {
            "type": "boolean",
            "description": "Shows messages where <var>text</var> matches the sender.",
            "optional": true
          },
          "subject": {
            "type": "boolean",
            "description": "Shows messages where <var>text</var> matches the subject.",
            "optional": true
          },
          "body": {
            "type": "boolean",
            "description": "Shows messages where <var>text</var> matches the message body.",
            "optional": true
          }
        }
      }
    ],
    "functions": [
      {
        "name": "getAll",
        "type": "function",
        "description": "Returns an array of all mail tabs in all windows.",
        "async": true,
        "parameters": []
      },
      {
        "name": "getCurrent",
        "type": "function",
        "description": "Returns the current mail tab in the most recent window, or throws an exception if the current tab is not a mail tab.",
        "async": true,
        "parameters": []
      },
      {
        "name": "update",
        "type": "function",
        "description": "Modifies the properties of a mail tab. Properties that are not specified in <var>updateProperties</var> are not modified.",
        "async": true,
        "parameters": [
          {
            "name": "tabId",
            "type": "integer",
            "description": "Defaults to the selected tab of the current window.",
            "optional": true,
            "minimum": 1
          },
          {
            "name": "updateProperties",
            "type": "object",
            "properties": {
              "displayedFolder": {
                "type": "object",
                "description": "Sets the folder displayed in the tab. The extension must have an accounts permission to do this.",
                "optional": true,
                "properties": {
                  "accountId": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string",
                    "optional": true
                  },
                  "path": {
                    "type": "string"
                  }
                }
              },
              "sortType": {
                "type": "string",
                "description": "Sorts the list of messages. <var>sortOrder</var> must also be given.",
                "optional": true,
                "enum": [
                  "byNone",
                  "byDate",
                  "bySubject",
                  "byAuthor",
                  "byId",
                  "byThread",
                  "byPriority",
                  "byStatus",
                  "bySize",
                  "byFlagged",
                  "byUnread",
                  "byRecipient",
                  "byLocation",
                  "byTags",
                  "byJunkStatus",
                  "byAttachments",
                  "byAccount",
                  "byCustom",
                  "byReceived",
                  "byCorrespondent"
                ]
              },
              "sortOrder": {
                "type": "string",
                "description": "Sorts the list of messages. <var>sortType</var> must also be given.",
                "optional": true,
                "enum": [
                  "none",
                  "ascending",
                  "descending"
                ]
              },
              "layout": {
                "type": "string",
                "description": "Sets the arrangement of the folder pane, message list pane, and message display pane. Note that setting this applies it to all mail tabs.",
                "optional": true,
                "enum": [
                  "standard",
                  "wide",
                  "vertical"
                ]
              },
              "folderPaneVisible": {
                "type": "boolean",
                "description": "Shows or hides the folder pane.",
                "optional": true
              },
              "messagePaneVisible": {
                "type": "boolean",
                "description": "Shows or hides the message display pane.",
                "optional": true
              }
            }
          }
        ]
      },
      {
        "name": "getSelectedMessages",
        "type": "function",
        "description": "Lists the selected messages in the current folder. A messages permission is required to do this.",
        "async": true,
        "parameters": [
          {
            "name": "tabId",
            "type": "integer",
            "description": "Defaults to the selected tab of the current window.",
            "optional": true,
            "minimum": 1
          }
        ]
      },
      {
        "name": "setQuickFilter",
        "type": "function",
        "description": "Sets the Quick Filter user interface based on the options specified.",
        "async": true,
        "parameters": [
          {
            "name": "tabId",
            "type": "integer",
            "description": "Defaults to the selected tab of the current window.",
            "optional": true,
            "minimum": 1
          },
          {
            "name": "properties",
            "type": "object",
            "properties": {
              "show": {
                "type": "boolean",
                "description": "Shows or hides the Quick Filter bar.",
                "optional": true
              },
              "unread": {
                "type": "boolean",
                "description": "Shows only unread messages.",
                "optional": true
              },
              "starred": {
                "type": "boolean",
                "description": "Shows only starred messages.",
                "optional": true
              },
              "contact": {
                "type": "boolean",
                "description": "Shows only messages from people in the address book.",
                "optional": true
              },
              "tags": {
                "optional": true,
                "choices": [
                  {
                    "type": "boolean"
                  },
                  {
                    "$ref": "QuickFilterTagsDetail"
                  }
                ],
                "description": "Shows only messages with tags on them."
              },
              "attachment": {
                "type": "boolean",
                "description": "Shows only messages with attachments.",
                "optional": true
              },
              "text": {
                "$ref": "QuickFilterTextDetail",
                "description": "Shows only messages matching the supplied text.",
                "optional": true
              }
            }
          }
        ]
      }
    ],
    "events": [
      {
        "name": "onDisplayedFolderChanged",
        "type": "function",
        "description": "Fired when the displayed folder changes in any mail tab.",
        "parameters": []
      },
      {
        "name": "onSelectedMessagesChanged",
        "type": "function",
        "description": "Fired when the selected messages change in any mail tab.",
        "parameters": []
      }
    ]
  }
]
