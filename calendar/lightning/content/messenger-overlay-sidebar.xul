<?xml version="1.0"?>

<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->

<!DOCTYPE overlay
[
  <!ENTITY % dtd1 SYSTEM "chrome://lightning/locale/lightning.dtd" > %dtd1;
  <!ENTITY % dtd2 SYSTEM "chrome://calendar/locale/menuOverlay.dtd" > %dtd2;
  <!ENTITY % dtd3 SYSTEM "chrome://calendar/locale/calendar.dtd" > %dtd3;
  <!ENTITY % dtd4 SYSTEM "chrome://lightning/locale/lightning-toolbar.dtd" > %dtd4;
  <!ENTITY % messengerDTD SYSTEM "chrome://messenger/locale/messenger.dtd" > %messengerDTD;
  <!ENTITY % eventDialogDTD SYSTEM "chrome://calendar/locale/calendar-event-dialog.dtd" > %eventDialogDTD;
  <!ENTITY % globalDTD SYSTEM "chrome://global/locale/global.dtd" > %globalDTD;
  <!ENTITY % calendarGlobalDTD SYSTEM "chrome://calendar/locale/global.dtd" > %calendarGlobalDTD;
  <!ENTITY % mailOverlayDTD SYSTEM "chrome://messenger/locale/mailOverlay.dtd"> %mailOverlayDTD;
  <!ENTITY % brandDTD SYSTEM "chrome://branding/locale/brand.dtd" > %brandDTD;
]>

<?xml-stylesheet href="chrome://lightning/skin/lightning.css" type="text/css"?>

<?xml-stylesheet href="chrome://calendar/skin/calendar-event-dialog.css" type="text/css"?>
<?xml-stylesheet href="chrome://calendar/content/calendar-event-dialog.css" type="text/css"?>
<?xml-stylesheet href="chrome://calendar-common/skin/dialogs/calendar-event-dialog.css" type="text/css"?>

<?xml-stylesheet href="chrome://calendar/skin/today-pane.css" type="text/css"?>

<?xml-stylesheet href="chrome://calendar/skin/calendar-unifinder.css" type="text/css"?>

<?xml-stylesheet href="chrome://calendar/skin/calendar-task-tree.css" type="text/css"?>
<?xml-stylesheet href="chrome://calendar/skin/calendar-task-view.css" type="text/css"?>

<?xml-stylesheet href="chrome://calendar/skin/calendar-views.css" type="text/css"?>
<?xml-stylesheet href="chrome://calendar-common/skin/calendar-alarms.css" type="text/css"?>
<?xml-stylesheet href="chrome://calendar-common/skin/widgets/minimonth.css" type="text/css"?>
<?xml-stylesheet href="chrome://calendar/skin/widgets/calendar-widgets.css" type="text/css"?>

<?xml-stylesheet href="chrome://lightning/skin/lightning-toolbar.css" type="text/css"?>

<overlay id="ltnSidebarOverlay"
         xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml">

  <script src="chrome://lightning/content/lightning-utils.js"/>
  <script src="chrome://lightning/content/messenger-overlay-sidebar.js"/>

  <script src="chrome://calendar/content/calendar-day-label.js"/>

  <!-- NEEDED FOR MULTIPLE CALENDAR SUPPORT AND TODAY PANE -->
  <script src="chrome://calendar/content/calendar-management.js"/>

  <!-- NEEDED FOR CLIPBOARD SUPPORT -->
  <script src="chrome://calendar/content/calendar-clipboard.js"/>

  <!-- NEEDED FOR IMPORT / EXPORT SUPPORT -->
  <script src="chrome://calendar/content/import-export.js"/>

  <!-- NEEDED FOR PUBLICATION SUPPORT -->
  <script src="chrome://calendar/content/publish.js"/>

  <script src="chrome://calendar/content/calendar-item-editing.js"/>
  <script src="chrome://calendar/content/calendar-chrome-startup.js"/>
  <script src="chrome://calendar/content/mouseoverPreviews.js"/>
  <script src="chrome://calendar/content/calendar-ui-utils.js"/>

  <script src="chrome://calendar/content/calendar-views-utils.js"/>
  <script src="chrome://calendar/content/calendar-base-view.js"/>
  <script src="chrome://calendar/content/calendar-month-base-view.js"/>
  <script src="chrome://calendar/content/widgets/calendar-dnd-widgets.js"/>
  <script src="chrome://calendar/content/calendar-multiday-base-view.js"/>
  <script src="chrome://calendar/content/calendar-views.js"/>
  <script src="chrome://calendar/content/calendar-editable-item.js"/>
  <script src="chrome://calendar/content/calendar-month-view.js"/>
  <script src="chrome://calendar/content/calendar-multiday-view.js"/>
  <script src="chrome://calendar/content/calendar-event-column.js"/>

  <script src="chrome://calendar/content/calendar-creation.js"/>
  <script src="chrome://calendar/content/calendar-dnd-listener.js"/>
  <script src="chrome://calendar/content/calendar-statusbar.js"/>
  <script src="chrome://calendar/content/widgets/calendar-minimonth.js"/>
  <script src="chrome://global/content/nsDragAndDrop.js"/>
  <script src="chrome://calendar/content/widgets/calendar-modebox.js"/>

  <!-- NEEDED FOR TASK VIEW/LIST SUPPORT -->
  <script src="chrome://calendar/content/calendar-task-editing.js"/>

  <script src="chrome://calendar/content/calendar-extract.js"/>

  <script src="chrome://calendar/content/calendar-invitations-manager.js"/>

  <!-- NEEDED FOR EVENT/TASK IN A TAB -->
  <script src="chrome://lightning/content/lightning-item-panel.js"/>

  <script src="chrome://calendar/content/calendar-command-controller.js"/>

  <!-- NEEDED FOR TODAY PANE -->
  <script src="chrome://calendar/content/agenda-listbox.js"/>
  <script src="chrome://calendar/content/today-pane.js"/>
  <script src="chrome://calendar/content/agenda-listbox-utils.js"/>

  <!-- NEEDED FOR EVENTS VIEW (UNIFINDER) -->
  <script src="chrome://calendar/content/calendar-unifinder.js"/>

  <!-- NEEDED FOR TODAY PANE AND TASKS VIEW -->
  <script src="chrome://calendar/content/calFilter.js"/>
  <script src="chrome://calendar/content/calendar-task-tree-utils.js"/>

  <!-- NEEDED FOR TASK VIEW -->
  <script src="chrome://calendar/content/calendar-task-tree-view.js"/>
  <script src="chrome://calendar/content/calendar-task-tree.js"/>
  <script src="chrome://calendar/content/calendar-task-view.js"/>
  <script src="chrome://calendar/content/calendar-dialog-utils.js"/>
  <script src="chrome://calendar/content/calApplicationUtils.js"/>
  <script src="chrome://calendar/content/calendar-item-bindings.js"/>
  <script src="chrome://calendar/content/calendar-menus.js"/>

  <!-- NEEDED FOR CALENDAR VIEWS -->
  <script src="chrome://calendar/content/calendar-event-gripbar.js"/>

  <window id="messengerWindow">
    <commandset id="calendar_commands"
                commandupdater="true"
                events="calendar_commands"
                oncommandupdate="calendarController.updateCommands()">
      <command id="agenda_delete_event_command" oncommand="agendaListbox.deleteSelectedItem(false);"/>
      <command id="agenda_edit_event_command" oncommand="agendaListbox.editSelectedItem(event);"/>
      <command id="switch2calendar"
               oncommand="document.getElementById('tabmail').openTab('calendar', { title: document.getElementById('calendar-tab-button').getAttribute('title') })"/>
      <command id="switch2task"
               oncommand="document.getElementById('tabmail').openTab('tasks', { title: document.getElementById('task-tab-button').getAttribute('title') })"/>
      <command id="new_calendar_tab"
               oncommand="document.getElementById('tabmail').openTab('calendar', { title: document.getElementById('calendar-tab-button').getAttribute('title') })"/>
      <command id="new_task_tab"
               oncommand="document.getElementById('tabmail').openTab('tasks', { title: document.getElementById('task-tab-button').getAttribute('title') })"/>
      <command id="calendar_go_to_today_command"
               observes="calendar_mode_calendar"
               oncommand="document.getElementById('tabmail').openTab('calendar', { title: document.getElementById('calendar-tab-button').getAttribute('title') }); goToDate(cal.dtz.now())"/>
      <command id="calendar_new_calendar_command" oncommand="goDoCommand('calendar_new_calendar_command')"/>
      <command id="calendar_delete_calendar_command" oncommand="goDoCommand('calendar_delete_calendar_command')"/>
      <command id="calendar_edit_calendar_command" oncommand="goDoCommand('calendar_edit_calendar_command')"/>

      <command id="calendar_new_event_command" oncommand="goDoCommand('calendar_new_event_command')"/>
      <command id="calendar_new_event_todaypane_command" oncommand="agendaListbox.createNewEvent(event)"/>
      <command id="calendar_new_event_context_command" oncommand="goDoCommand('calendar_new_event_context_command')"/>
      <command id="calendar_modify_event_command" oncommand="goDoCommand('calendar_modify_event_command')"/>
      <command id="calendar_delete_event_command" oncommand="goDoCommand('calendar_delete_event_command')"/>

      <command id="calendar_new_todo_command" oncommand="goDoCommand('calendar_new_todo_command')"/>
      <command id="calendar_new_todo_context_command" oncommand="goDoCommand('calendar_new_todo_context_command')"/>
      <command id="calendar_new_todo_todaypane_command" oncommand="goDoCommand('calendar_new_todo_todaypane_command')"/>
      <command id="calendar_modify_todo_command" oncommand="goDoCommand('calendar_modify_todo_command')"/>
      <command id="calendar_modify_todo_todaypane_command" oncommand="goDoCommand('calendar_modify_todo_todaypane_command')"/>
      <command id="calendar_delete_todo_command" oncommand="goDoCommand('calendar_delete_todo_command')"/>

      <command id="calendar_modify_focused_item_command" oncommand="goDoCommand('calendar_modify_focused_item_command')"/>
      <command id="calendar_delete_focused_item_command" oncommand="goDoCommand('calendar_delete_focused_item_command')"/>

      <command id="calendar_import_command" oncommand="goDoCommand('calendar_import_command')"/>
      <command id="calendar_export_command" oncommand="goDoCommand('calendar_export_command')"/>
      <command id="calendar_export_selection_command" oncommand="goDoCommand('calendar_export_selection_command')"/>

      <command id="calendar_publish_selected_calendar_command" oncommand="goDoCommand('calendar_publish_selected_calendar_command')"/>
      <command id="calendar_publish_calendar_command" oncommand="goDoCommand('calendar_publish_calendar_command')"/>
      <command id="calendar_publish_selected_events_command" oncommand="goDoCommand('calendar_publish_selected_events_command')"/>

      <command id="calendar_reload_remote_calendars" oncommand="goDoCommand('calendar_reload_remote_calendars')"/>

      <command id="calendar_show_unifinder_command" oncommand="goDoCommand('calendar_show_unifinder_command')"/>
      <!-- The dash instead of the underscore is intended. the 'xxx-view' part should be the id of the view in the deck -->
      <command id="calendar_day-view_command" oncommand="goDoCommand('calendar_day-view_command')"/>
      <command id="calendar_week-view_command" oncommand="goDoCommand('calendar_week-view_command')"/>
      <command id="calendar_multiweek-view_command" oncommand="goDoCommand('calendar_multiweek-view_command')"/>
      <command id="calendar_month-view_command" oncommand="goDoCommand('calendar_month-view_command')"/>
      <command id="calendar_task_category_command"/>
      <command id="calendar_toggle_completed_command" oncommand="toggleCompleted(event)"/>
      <command id="calendar_percentComplete-0_command" oncommand="contextChangeTaskProgress(event, 0)"/>
      <command id="calendar_percentComplete-25_command" oncommand="contextChangeTaskProgress(event, 25)"/>
      <command id="calendar_percentComplete-50_command" oncommand="contextChangeTaskProgress(event, 50)"/>
      <command id="calendar_percentComplete-75_command" oncommand="contextChangeTaskProgress(event, 75)"/>
      <command id="calendar_percentComplete-100_command" oncommand="contextChangeTaskProgress(event, 100)"/>
      <command id="calendar_priority-0_command" oncommand="contextChangeTaskPriority(event, 0)"/>
      <command id="calendar_priority-9_command" oncommand="contextChangeTaskPriority(event, 9)"/>
      <command id="calendar_priority-5_command" oncommand="contextChangeTaskPriority(event, 5)"/>
      <command id="calendar_priority-1_command" oncommand="contextChangeTaskPriority(event, 1)"/>
      <command id="calendar_general-priority_command" oncommand="goDoCommand('calendar_general-priority_command')"/>
      <command id="calendar_general-progress_command" oncommand="goDoCommand('calendar_general-progress_command')"/>
      <command id="calendar_general-postpone_command"/>
      <command id="calendar_postpone-1hour_command" oncommand="contextPostponeTask(event, 'PT1H')"/>
      <command id="calendar_postpone-1day_command" oncommand="contextPostponeTask(event, 'P1D')"/>
      <command id="calendar_postpone-1week_command" oncommand="contextPostponeTask(event, 'P1W')"/>
      <command id="calendar_toggle_orientation_command" persist="checked" oncommand="goDoCommand('calendar_toggle_orientation_command')"/>
      <command id="calendar_toggle_workdays_only_command" persist="checked" oncommand="goDoCommand('calendar_toggle_workdays_only_command')"/>
      <command id="calendar_toggle_tasks_in_view_command" persist="checked" oncommand="toggleTasksInView()"/>
      <command id="calendar_toggle_show_completed_in_view_command" persist="checked" oncommand="toggleShowCompletedInView()"/>
      <command id="calendar_toggle_calendarsidebar_command" oncommand="togglePaneSplitter('calsidebar_splitter')"/>
      <command id="calendar_toggle_minimonthpane_command" oncommand="document.getElementById('minimonth-pane').togglePane(event)"/>
      <command id="calendar_toggle_calendarlist_command" oncommand="document.getElementById('calendar-list-pane').togglePane(event)"/>
      <command id="calendar_task_filter_command" oncommand="taskViewUpdate(event.explicitOriginalTarget.getAttribute('value'))"/>
      <command id="calendar_task_filter_todaypane_command" oncommand="TodayPane.updateCalendarToDoUnifinder(event.explicitOriginalTarget.getAttribute('value'))"/>
      <command id="calendar_toggle_filter_command" oncommand="document.getElementById('task-filter-pane').togglePane(event)"/>
      <command id="calendar_view_next_command" oncommand="goDoCommand('calendar_view_next_command')"/>
      <command id="calendar_view_today_command" oncommand="currentView().moveView()"/>
      <command id="calendar_view_prev_command" oncommand="goDoCommand('calendar_view_prev_command')"/>

      <!-- this is a pseudo-command that is disabled when in calendar mode -->
      <command id="calendar_in_foreground"/>
      <!-- this is a pseudo-command that is disabled when not in calendar mode -->
      <command id="calendar_in_background"/>

      <!-- These commands are enabled when in calendar or task mode, respectively -->
      <command id="calendar_mode_calendar"/>
      <command id="calendar_mode_task"/>

      <command id="calendar_attendance_command"/>

      <command id="calendar_toggle_todaypane_command" oncommand="TodayPane.toggleVisibility(event)"/>
    </commandset>

    <commandset id="mailCommands">
      <command id="cmd_CustomizeMailToolbar"
               oncommand="customizeMailToolbarForTabType()"/>
    </commandset>

    <keyset id="calendar-keys">
      <key id="openLightningKey"
           key="&lightning.keys.event.showCalendar.key;"
           modifiers="accel, shift"
           command="new_calendar_tab"/>
      <key id="openTasksKey"
           key="&lightning.keys.event.showTasks.key;"
           modifiers="accel, shift"
           command="new_task_tab"/>
      <key id="todaypanekey" command="calendar_toggle_todaypane_command" keycode="VK_F11"/>
      <key id="calendar-new-event-key" key="&lightning.keys.event.new;" modifiers="accel" command="calendar_new_event_command"/>
      <key id="calendar-new-todo-key" key="&lightning.keys.todo.new;" modifiers="accel" command="calendar_new_todo_command"/>
<!--
  For linux tab switching reserves alt+number, where on windows that's ctrl.
  Use the available modifiers for each platform.
  Can't use the OPTION key on OSX, so we will use SHIFT+OPTION on the Mac.
-->
      <key id="calendar-day-view-key" key="1"
          command="calendar_day-view_command"
          modifiers-linux="accel"
          modifiers-macosx="shift alt"
          modifiers-win="alt"/>
      <key id="calendar-week-view-key" key="2"
          command="calendar_week-view_command"
          modifiers-linux="accel"
          modifiers-macosx="shift alt"
          modifiers-win="alt"/>
      <key id="calendar-multiweek-view-key" key="3"
          command="calendar_multiweek-view_command"
          modifiers-linux="accel"
          modifiers-macosx="shift alt"
          modifiers-win="alt"/>
      <key id="calendar-month-view-key" key="4"
          command="calendar_month-view_command"
          modifiers-linux="accel"
          modifiers-macosx="shift alt"
          modifiers-win="alt"/>
      <key id="calendar-go-to-today-key" keycode="VK_END"
          command="calendar_go_to_today_command" modifiers="alt"/>
      <key id="calendar-delete-item-key" keycode="VK_DELETE"
          command="calendar_delete_event_command"/>
      <key id="calendar-delete-todo-key" keycode="VK_DELETE"
          command="calendar_delete_todo_command"/>
    </keyset>

    <popupset id="calendar-popupset">
      <!-- Tooltips -->
      <tooltip id="calendar-list-tooltip"
               onpopupshowing="return calendarListTooltipShowing(event)"/>

      <tooltip id="eventTreeTooltip"
              onpopupshowing="return showToolTip(this, unifinderTreeView.getItemFromEvent(event))"
              noautohide="true"/>

      <tooltip id="taskTreeTooltip"
              onpopupshowing="return showToolTip(this, getTaskTree().getTaskFromEvent(event))"
              noautohide="true"/>

      <tooltip id="itemTooltip"
              noautohide="true"/>

      <!-- CALENDAR TOOLBAR CONTEXT MENU -->
      <menupopup id="calendar-toolbar-context"
                 onpopupshowing="onViewToolbarsPopupShowing(event, ['navigation-toolbox', 'calendar-toolbox']);">
        <menuseparator id="customizeCalendarToolbarMenuSeparator"/>
        <menuitem id="CustomizeCalendarToolbar"
                  label="&calendar.menu.customize.label;"
                  accesskey="&calendar.menu.customize.accesskey;"
                  oncommand="CustomizeMailToolbar('calendar-toolbox', 'CustomizeCalendarToolbar')"/>
      </menupopup>
      <menupopup id="task-toolbar-context"
                 onpopupshowing="onViewToolbarsPopupShowing(event, ['navigation-toolbox', 'task-toolbox']);">
        <menuseparator id="customizeTaskToolbarMenuSeparator"/>
        <menuitem id="CustomizeTaskToolbar"
                  label="&calendar.menu.customize.label;"
                  accesskey="&calendar.menu.customize.accesskey;"
                  oncommand="CustomizeMailToolbar('task-toolbox', 'CustomizeTaskToolbar')"/>
      </menupopup>

      <!-- CALENDAR LIST CONTEXT MENU -->
      <menupopup id="list-calendars-context-menu"
                 onpopupshowing="return calendarListSetupContextMenu(event);">
        <menuitem id="list-calendars-context-togglevisible"
                  class="needs-calendar"
                  accesskeyshow="&calendar.context.showcalendar.accesskey;"
                  accesskeyhide="&calendar.context.hidecalendar.accesskey;"
                  oncommand="toggleCalendarVisible(document.getElementById('list-calendars-context-menu').contextCalendar);"/>
        <menuitem id="list-calendars-context-showonly"
                  class="needs-calendar"
                  accesskey="&calendar.context.showonly.accesskey;"
                  oncommand="showOnlyCalendar(document.getElementById('list-calendars-context-menu').contextCalendar);"/>
        <menuitem id="list-calendars-context-showall"
                  label="&calendar.context.showall.label;"
                  accesskey="&calendar.context.showall.accesskey;"
                  oncommand="showAllCalendars();"/>
        <menuseparator id="list-calendars-context-showops-menuseparator"/>
        <menuitem id="list-calendars-context-new"
                  label="&calendar.context.newserver.label;"
                  accesskey="&calendar.context.newserver.accesskey;"
                  command="calendar_new_calendar_command"/>
        <menuitem id="list-calendars-context-find"
                  label="&calendar.context.findcalendar.label;"
                  accesskey="&calendar.context.findcalendar.accesskey;"
                  oncommand="openCalendarSubscriptionsDialog();"/>
        <menuitem id="list-calendars-context-delete"
                  class="needs-calendar"
                  labeldelete="&calendar.context.deleteserver2.label;"
                  labelremove="&calendar.context.removeserver.label;"
                  labelunsubscribe="&calendar.context.unsubscribeserver.label;"
                  accesskeydelete="&calendar.context.deleteserver2.accesskey;"
                  accesskeyremove="&calendar.context.removeserver.accesskey;"
                  accesskeyunsubscribe="&calendar.context.unsubscribeserver.accesskey;"
                  command="calendar_delete_calendar_command"/>
        <menuseparator id="list-calendars-context-itemops-menuseparator"/>
        <menuitem id="list-calendars-context-export"
                  class="needs-calendar"
                  label="&calendar.context.export.label;"
                  accesskey="&calendar.context.export.accesskey;"
                  oncommand="exportEntireCalendar(document.getElementById('list-calendars-context-menu').contextCalendar);"/>
        <menuitem id="list-calendars-context-publish"
                  class="needs-calendar"
                  label="&calendar.context.publish.label;"
                  accesskey="&calendar.context.publish.accesskey;"
                  command="calendar_publish_selected_calendar_command"/>
        <menuseparator id="list-calendars-context-export-menuseparator"
                  class="needs-calendar"/>
        <menuitem id="list-calendars-context-reload"
                  label="&calendar.context.synccalendars.label;"
                  accesskey="&calendar.context.synccalendars.accesskey;"
                  command="calendar_reload_remote_calendars"/>
        <menuseparator id="list-calendars-context-reload-menuseparator"
                       class="needs-calendar"/>
        <menuitem id="list-calendars-context-edit"
                  class="needs-calendar"
                  label="&calendar.context.properties.label;"
                  accesskey="&calendar.context.properties.accesskey;"
                  command="calendar_edit_calendar_command"/>
      </menupopup>

      <!-- CALENDAR ITEM CONTEXT MENU -->
      <menupopup id="calendar-item-context-menu"
                 onpopupshowing="return setupContextItemType(event, currentView().getSelectedItems({}));">
        <menuitem id="calendar-item-context-menu-modify-menuitem"
                  label="&calendar.context.modifyorviewitem.label;"
                  accesskey="&calendar.context.modifyorviewitem.accesskey;"
                  command="calendar_modify_event_command"/>
        <menuitem id="calendar-item-context-menu-newevent-menutitem"
                  label="&calendar.context.newevent.label;"
                  accesskey="&calendar.context.newevent.accesskey;"
                  key="calendar-new-event-key"
                  command="calendar_new_event_context_command"/>
        <menuitem id="calendar-item-context-menu-newtodo-menuitem"
                  label="&calendar.context.newtodo.label;"
                  accesskey="&calendar.context.newtodo.accesskey;"
                  key="calendar-new-todo-key"
                  command="calendar_new_todo_context_command"/>
        <menuseparator id="calendar-item-context-menuseparator-adddeletemodify"/>
        <menuitem id="calendar-item-context-menu-cut-menuitem"
                  label="&calendar.context.cutevent.label;"
                  accesskey="&calendar.context.cutevent.accesskey;"
                  key="key_cut"
                  command="cmd_cut"/>
        <menuitem id="calendar-item-context-menu-copy-menuitem"
                  label="&calendar.context.copyevent.label;"
                  accesskey="&calendar.context.copyevent.accesskey;"
                  key="key_copy"
                  command="cmd_copy"/>
        <menuitem id="calendar-item-context-menu-paste-menuitem"
                  label="&calendar.context.pasteevent.label;"
                  accesskey="&calendar.context.pasteevent.accesskey;"
                  key="key_paste"
                  command="cmd_paste"/>
        <menuseparator id="calendar-item-context-separator-cutcopypaste"/>
        <menu id="calendar-item-context-menu-convert-menu"
              label="&calendar.context.convertmenu.label;"
              accesskey="&calendar.context.convertmenu.accesskey.calendar;">
          <menupopup id="calendar-item-context-menu-convert-menupopup">
            <menuitem id="calendar-view-context-menu-convert-message-menuitem"
                      label="&calendar.context.convertmenu.message.label;"
                      accesskey="&calendar.context.convertmenu.message.accesskey;"
                      oncommand="calendarMailButtonDNDObserver.onDropItems(currentView().getSelectedItems({}))"/>
            <menuitem id="calendar-item-context-menu-convert-event-menuitem"
                      class="todo-only"
                      label="&calendar.context.convertmenu.event.label;"
                      accesskey="&calendar.context.convertmenu.event.accesskey;"
                      oncommand="calendarCalendarButtonDNDObserver.onDropItems(currentView().getSelectedItems({}))"/>
            <menuitem id="calendar-item-context-menu-convert-task-menuitem"
                      class="event-only"
                      label="&calendar.context.convertmenu.task.label;"
                      accesskey="&calendar.context.convertmenu.task.accesskey;"
                      oncommand="calendarTaskButtonDNDObserver.onDropItems(currentView().getSelectedItems({}))"/>
          </menupopup>
        </menu>
        <menuseparator id="calendar-menuseparator-before-delete"/>
        <!-- the label and accesskey of the following menuitem is set during runtime,
            and depends on whether the item is a task or an event -->
        <menuitem id="calendar-item-context-menu-delete-menuitem"
                  key="calendar-delete-item-key"
                  command="calendar_delete_event_command"/>
        <menu id="calendar-item-context-menu-attendance-menu"
              label="&calendar.context.attendance.menu.label;"
              accesskey="&calendar.context.attendance.menu.accesskey;"
              oncommand="setContextPartstat(event.target, currentView().getSelectedItems({}))"
              observes="calendar_attendance_command">
          <menupopup id="calendar-item-context-menu-attendance-menupopup">
            <label id="calendar-item-context-attendance-thisoccurrence-label"
                  class="calendar-context-heading-label"
                  scope="this-occurrence"
                  value="&calendar.context.attendance.occurrence.label;"/>
            <menu id="calendar-item-context-menu-attendance-accepted-menu"
                  label="&calendar.context.attendance.occ.accepted.label;"
                  accesskey="&calendar.context.attendance.occ.accepted.accesskey;"
                  value="ACCEPTED"
                  name="calendar-item-context-attendance"
                  scope="this-occurrence">
              <menupopup id="calendar-item-context-menu-occurrence-accepted-menupopup">
                <menuitem id="calendar-item-context-menu-attend-accept-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="AUTO"/>
                <menuitem id="calendar-item-context-menu-attend-accept-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="calendar-item-context-menu-attendance-tentative-menu"
                  label="&calendar.context.attendance.occ.tentative.label;"
                  accesskey="&calendar.context.attendance.occ.tentative.accesskey;"
                  value="TENTATIVE"
                  name="calendar-item-context-attendance"
                  scope="this-occurrence">
              <menupopup id="calendar-item-context-menu-occurrence-tentative-menupopup">
                <menuitem id="calendar-item-context-menu-attend-tentative-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="AUTO"/>
                <menuitem id="calendar-item-context-menu-attend-tentative-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="calendar-item-context-menu-attendance-declined-menu"
                  label="&calendar.context.attendance.occ.declined.label;"
                  accesskey="&calendar.context.attendance.occ.declined.accesskey;"
                  value="DECLINED"
                  name="calendar-item-context-attendance"
                  scope="this-occurrence">
              <menupopup id="calendar-item-context-menu-occurrence-tentative-menupopup">
                <menuitem id="calendar-item-context-menu-attend-declined-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="DECLINED"
                          respmode="AUTO"/>
                <menuitem id="calendar-item-context-menu-attend-declined-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="DECLINED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menuitem id="calendar-item-context-menu-attendance-delegated-menu"
                      label="&calendar.context.attendance.occ.delegated.label;"
                      name="calendar-item-context-attendance"
                      scope="this-occurrence"
                      value="DELEGATED"/>
            <menuitem id="calendar-item-context-menu-attendance-needsaction-menu"
                      label="&calendar.context.attendance.occ.needsaction.label;"
                      name="calendar-item-context-attendance"
                      scope="this-occurrence"
                      value="NEEDS-ACTION"/>
            <label id="calendar-item-context-attendance-alloccurrence-label"
                  class="calendar-context-heading-label"
                  scope="all-occurrences"
                  value="&calendar.context.attendance.all2.label;"/>
            <menu id="calendar-item-context-menu-attendance-accepted-all-menu"
                  label="&calendar.context.attendance.all.accepted.label;"
                  accesskey="&calendar.context.attendance.all.accepted.accesskey;"
                  value="ACCEPTED"
                  name="calendar-item-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="calendar-item-context-menu-alloccurrences-accept-menupopup">
                <menuitem id="calendar-item-context-menu-attend-accept-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="AUTO"/>
                <menuitem id="calendar-item-context-menu-attend-accept-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="calendar-item-context-menu-attendance-tentative-all-menu"
                  label="&calendar.context.attendance.all.tentative.label;"
                  accesskey="&calendar.context.attendance.all.tentative.accesskey;"
                  value="TENTATIVE"
                  name="calendar-item-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="calendar-item-context-menu-alloccurrences-tentative-menupopup">
                <menuitem id="calendar-item-context-menu-attend-tentative-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="AUTO"/>
                <menuitem id="calendar-item-context-menu-attend-tentative-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="calendar-item-context-menu-attendance-decline-all-menu"
                  label="&calendar.context.attendance.all.declined.label;"
                  accesskey="&calendar.context.attendance.all.declined.accesskey;"
                  value="DECLINED"
                  name="calendar-item-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="calendar-item-context-menu-alloccurrences-decline-menupopup">
                <menuitem id="calendar-item-context-menu-attend-declined-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="DECLINED"
                          respmode="AUTO"/>
                <menuitem id="calendar-item-context-menu-attend-declined-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="DECLINED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menuitem id="calendar-item-context-menu-attendance-delegated-all-menu"
                      label="&calendar.context.attendance.all.delegated.label;"
                      name="calendar-item-context-attendance-delegated-all"
                      scope="all-occurrences"
                      value="DELEGATED"/>
            <menuitem id="calendar-item-context-menu-attendance-needsaction-all-menu"
                      label="&calendar.context.attendance.all.needsaction.label;"
                      name="calendar-item-context-attendance-needaction-all"
                      scope="all-occurrences"
                      value="NEEDS-ACTION"/>
          </menupopup>
        </menu>
      </menupopup>

      <!-- CALENDAR VIEW CONTEXT MENU -->
      <menupopup id="calendar-view-context-menu">
        <menuitem id="calendar-view-context-menu-newevent"
                  label="&calendar.context.newevent.label;"
                  command="calendar_new_event_context_command"
                  accesskey="&calendar.context.newevent.accesskey;"
                  key="calendar-new-event-key"/>
        <menuitem id="calendar-view-context-menu-newtodo"
                  label="&calendar.context.newtodo.label;"
                  command="calendar_new_todo_context_command"
                  accesskey="&calendar.context.newtodo.accesskey;"
                  key="calendar-new-todo-key"/>
        <!-- These labels are set dynamically, based on the current view -->
        <menuitem id="calendar-view-context-menu-previous"
                  label=""
                  accesskey=""
                  command="calendar_view_prev_command"
                  label-day="&calendar.prevday.label;"
                  label-week="&calendar.prevweek.label;"
                  label-multiweek="&calendar.prevweek.label;"
                  label-month="&calendar.prevmonth.label;"
                  accesskey-day="&calendar.prevday.accesskey;"
                  accesskey-week="&calendar.prevweek.accesskey;"
                  accesskey-multiweek="&calendar.prevweek.accesskey;"
                  accesskey-month="&calendar.prevmonth.accesskey;"/>
        <menuitem id="calendar-view-context-menu-next"
                  label=""
                  command="calendar_view_next_command"
                  label-day="&calendar.nextday.label;"
                  label-week="&calendar.nextweek.label;"
                  label-multiweek="&calendar.nextweek.label;"
                  label-month="&calendar.nextmonth.label;"
                  accesskey-day="&calendar.nextday.accesskey;"
                  accesskey-week="&calendar.nextweek.accesskey;"
                  accesskey-multiweek="&calendar.nextweek.accesskey;"
                  accesskey-month="&calendar.nextmonth.accesskey;"/>
        <menuseparator id="calendar-item-context-separator-cutcopypaste"/>
        <!-- Cut and copy doesn't make sense in the views, but only showing paste
            makes it look like something is missing. Disable by default. -->
        <menuitem id="calendar-view-context-menu-cut-menuitem"
                  label="&calendar.context.cutevent.label;"
                  accesskey="&calendar.context.cutevent.accesskey;"
                  key="key_cut"
                  disabled="true"/>
        <menuitem id="calendar-view-context-menu-copy-menuitem"
                  label="&calendar.context.copyevent.label;"
                  accesskey="&calendar.context.copyevent.accesskey;"
                  key="key_copy"
                  disabled="true"/>
        <menuitem id="calendar-view-context-menu-paste-menuitem"
                  label="&calendar.context.pasteevent.label;"
                  accesskey="&calendar.context.pasteevent.accesskey;"
                  key="key_paste"
                  command="cmd_paste"/>
      </menupopup>

      <!-- TASK ITEM CONTEXT MENU -->
      <menupopup id="taskitem-context-menu"
                onpopupshowing="changeContextMenuForTask(event);"
                onpopuphiding="handleTaskContextMenuStateChange(event);">
        <menuitem id="task-context-menu-modify"
                  label="&calendar.context.modifyorviewtask.label;"
                  accesskey="&calendar.context.modifyorviewtask.accesskey;"
                  command="calendar_modify_todo_command"/>
        <menuitem id="task-context-menu-modify-todaypane"
                  label="&calendar.context.modifyorviewtask.label;"
                  accesskey="&calendar.context.modifyorviewtask.accesskey;"
                  command="calendar_modify_todo_todaypane_command"/>
        <menuitem id="task-context-menu-new"
                  label="&calendar.context.newtodo.label;"
                  accesskey="&calendar.context.newtodo.accesskey;"
                  key="calendar-new-todo-key"
                  command="calendar_new_todo_command"/>
        <menuitem id="task-context-menu-new-todaypane"
                  label="&calendar.context.newtodo.label;"
                  accesskey="&calendar.context.newtodo.accesskey;"
                  key="calendar-new-todo-key"
                  command="calendar_new_todo_todaypane_command"/>
        <menuseparator id="task-context-menuseparator-cutcopypaste"/>
        <menuitem id="task-context-menu-cut-menuitem"
                  label="&calendar.context.cutevent.label;"
                  accesskey="&calendar.context.cutevent.accesskey;"
                  key="key_cut"
                  command="cmd_cut"/>
        <menuitem id="task-context-menu-copy-menuitem"
                  label="&calendar.context.copyevent.label;"
                  accesskey="&calendar.context.copyevent.accesskey;"
                  key="key_copy"
                  command="cmd_copy"/>
        <menuitem id="task-context-menu-paste-menuitem"
                  label="&calendar.context.pasteevent.label;"
                  accesskey="&calendar.context.pasteevent.accesskey;"
                  key="key_paste"
                  command="cmd_paste"/>
        <menuseparator id="calendar-menuseparator-beforemarkcompleted"/>
        <menuitem id="calendar-context-markcompleted"
                  type="checkbox"
                  autocheck="false"
                  label="&calendar.context.markcompleted.label;"
                  accesskey="&calendar.context.markcompleted.accesskey;"
                  command="calendar_toggle_completed_command"/>
        <menu id="task-context-menu-progress"
              label="&calendar.context.progress.label;"
              accesskey="&calendar.context.progress.accesskey;"
              command="calendar_general-progress_command">
          <menupopup is="calendar-task-progress-menupopup"/>
        </menu>
        <menu id="task-context-menu-priority"
              label="&calendar.context.priority.label;"
              accesskey="&calendar.context.priority.accesskey;"
              command="calendar_general-priority_command">
          <menupopup is="calendar-task-priority-menupopup"/>
        </menu>
        <menu id="task-context-menu-postpone"
              label="&calendar.context.postpone.label;"
              accesskey="&calendar.context.postpone.accesskey;"
              command="calendar_general-postpone_command">
          <menupopup id="task-context-postpone-menupopup">
            <menuitem id="task-context-postpone-1hour"
                      label="&calendar.context.postpone.1hour.label;"
                      accesskey="&calendar.context.postpone.1hour.accesskey;"
                      command="calendar_postpone-1hour_command"/>
            <menuitem id="task-context-postpone-1day"
                      label="&calendar.context.postpone.1day.label;"
                      accesskey="&calendar.context.postpone.1day.accesskey;"
                      command="calendar_postpone-1day_command"/>
            <menuitem id="task-context-postpone-1week"
                      label="&calendar.context.postpone.1week.label;"
                      accesskey="&calendar.context.postpone.1week.accesskey;"
                      command="calendar_postpone-1week_command"/>
          </menupopup>
        </menu>
        <menu id="calendar-context-calendar-menu"
              label="&calendar.calendar.label;"
              accesskey="&calendar.calendar.accesskey;">
              <menupopup id="calendar-context-calendar-menupopup"
                        onpopupshowing="addCalendarNames(event);"/>
        </menu>
        <menuseparator id="task-context-menu-separator-conversion"/>
        <menu id="task-context-menu-convert"
              label="&calendar.context.convertmenu.label;"
              accesskey="&calendar.context.convertmenu.accesskey.calendar;">
          <menupopup id="task-context-convert-menupopup">
            <menuitem id="calendar-context-converttomessage"
                      label="&calendar.context.convertmenu.message.label;"
                      accesskey="&calendar.context.convertmenu.message.accesskey;"
                      oncommand="tasksToMail(event)"/>
            <menuitem id="calendar-context-converttoevent"
                      label="&calendar.context.convertmenu.event.label;"
                      accesskey="&calendar.context.convertmenu.event.accesskey;"
                      oncommand="tasksToEvents(event)"/>
          </menupopup>
        </menu>
        <menuseparator/>
        <menuitem id="task-context-menu-delete"
                  label="&calendar.context.deletetask.label;"
                  accesskey="&calendar.context.deletetask.accesskey;"
                  command="calendar_delete_todo_command"/>
        <menu id="task-context-menu-attendance-menu"
              label="&calendar.context.attendance.menu.label;"
              accesskey="&calendar.context.attendance.menu.accesskey;"
              oncommand="setContextPartstat(event.target, getSelectedTasks())"
              observes="calendar_attendance_command">
          <menupopup id="task-context-menu-attendance-menupopup">
            <label id="task-context-attendance-thisoccurrence-label"
                  class="calendar-context-heading-label"
                  scope="this-occurrence"
                  value="&calendar.context.attendance.occurrence.label;"/>
            <menu id="task-context-menu-attendance-accepted-menu"
                  label="&calendar.context.attendance.occ.accepted.label;"
                  accesskey="&calendar.context.attendance.occ.accepted.accesskey;"
                  value="ACCEPTED"
                  name="task-context-attendance"
                  scope="this-occurrence">
              <menupopup id="task-context-menu-occurrence-accepted-menupopup">
                <menuitem id="task-context-menu-attend-accept-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-accept-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-tentative-menu"
                  label="&calendar.context.attendance.occ.tentative.label;"
                  accesskey="&calendar.context.attendance.occ.tentative.accesskey;"
                  value="TENTATIVE"
                  name="task-context-attendance"
                  scope="this-occurrence">
              <menupopup id="task-context-menu-occurrence-tentative-menupopup">
                <menuitem id="task-context-menu-attend-tentative-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-tentative-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-declined-menu"
                  label="&calendar.context.attendance.occ.declined.label;"
                  accesskey="&calendar.context.attendance.occ.declined.accesskey;"
                  value="DECLINED"
                  name="task-context-attendance"
                  scope="this-occurrence">
              <menupopup id="task-context-menu-occurrence-tentative-menupopup">
                <menuitem id="task-context-menu-attend-declined-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="DECLINED"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-declined-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="DECLINED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-inprogress-menu"
                  label="&calendar.context.attendance.occ.inprogress.label;"
                  accesskey="&calendar.context.attendance.occ.inprogress.accesskey;"
                  value="IN-PROGRESS"
                  name="task-context-attendance"
                  scope="this-occurrence">
              <menupopup id="task-context-menu-occurrence-inprogress-menupopup">
                <menuitem id="task-context-menu-attend-inprogress-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="IN-PROGRESS"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-inprogress-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="IN-PROGRESS"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-completed-menu"
                  label="&calendar.context.attendance.occ.completed.label;"
                  accesskey="&calendar.context.attendance.occ.completed.accesskey;"
                  value="COMPLETED"
                  name="task-context-attendance"
                  scope="this-occurrence">
              <menupopup id="task-context-menu-occurrence-completed-menupopup">
                <menuitem id="task-context-menu-attend-completed-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="COMPLETED"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-completed-dontsend-menuitem"
                          scope="this-occurrence"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="COMPLETED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menuitem id="task-context-menu-attendance-delegated-menu"
                      label="&calendar.context.attendance.occ.delegated.label;"
                      name="task-context-attendance"
                      scope="this-occurrence"
                      value="DELEGATED"/>
            <menuitem id="task-context-menu-attendance-needsaction-menu"
                      label="&calendar.context.attendance.occ.needsaction.label;"
                      name="task-context-attendance"
                      scope="this-occurrence"
                      value="NEEDS-ACTION"/>
            <label id="task-context-attendance-alloccurrence-label"
                  class="calendar-context-heading-label"
                  scope="all-occurrences"
                  value="&calendar.context.attendance.all2.label;"/>
            <menu id="task-context-menu-attendance-accepted-all-menu"
                  label="&calendar.context.attendance.all.accepted.label;"
                  accesskey="&calendar.context.attendance.all.accepted.accesskey;"
                  value="ACCEPTED"
                  name="task-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="task-context-menu-alloccurrences-accept-menupopup">
                <menuitem id="task-context-menu-attend-accept-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-accept-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="ACCEPTED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-tentative-all-menu"
                  label="&calendar.context.attendance.all.tentative.label;"
                  accesskey="&calendar.context.attendance.all.tentative.accesskey;"
                  value="TENTATIVE"
                  name="task-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="task-context-menu-alloccurrences-tentative-menupopup">
                <menuitem id="task-context-menu-attend-tentative-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-tentative-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="TENTATIVE"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-decline-all-menu"
                  label="&calendar.context.attendance.all.declined.label;"
                  accesskey="&calendar.context.attendance.all.declined.accesskey;"
                  value="DECLINED"
                  name="task-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="task-context-menu-alloccurrences-decline-menupopup">
                <menuitem id="task-context-menu-attend-declined-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="DECLINED"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-declined-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="DECLINED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-inprogress-all-menu"
                  label="&calendar.context.attendance.all.inprogress.label;"
                  accesskey="&calendar.context.attendance.all.inprogress.accesskey;"
                  value="IN-PROGRESS"
                  name="task-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="task-context-menu-alloccurrences-inprogress-menupopup">
                <menuitem id="task-context-menu-attend-inprogress-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="IN-PROGRESS"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-inprogress-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="IN-PROGRESS"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menu id="task-context-menu-attendance-completed-all-menu"
                  label="&calendar.context.attendance.all.completed.label;"
                  accesskey="&calendar.context.attendance.all.completed.accesskey;"
                  value="COMPLETED"
                  name="task-context-attendance-all"
                  scope="all-occurrences">
              <menupopup id="task-context-menu-alloccurrences-completed-menupopup">
                <menuitem id="task-context-menu-attend-completed-all-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.send.label;"
                          accesskey="&calendar.context.attendance.send.accesskey;"
                          respvalue="COMPLETED"
                          respmode="AUTO"/>
                <menuitem id="task-context-menu-attend-completed-all-dontsend-menuitem"
                          scope="all-occurrences"
                          label="&calendar.context.attendance.dontsend.label;"
                          accesskey="&calendar.context.attendance.dontsend.accesskey;"
                          respvalue="COMPLETED"
                          respmode="NONE"/>
              </menupopup>
            </menu>
            <menuitem id="task-context-menu-attendance-delegated-all-menu"
                      label="&calendar.context.attendance.all.delegated.label;"
                      name="task-context-attendance-delegated-all"
                      scope="all-occurrences"
                      value="DELEGATED"/>
            <menuitem id="task-context-menu-attendance-needsaction-all-menu"
                      label="&calendar.context.attendance.all.delegated.label;"
                      name="task-context-attendance-needaction-all"
                      scope="all-occurrences"
                      value="NEEDS-ACTION"/>
          </menupopup>
        </menu>
        <menuseparator id="task-context-menu-separator-filter"/>
        <menu id="task-context-menu-filter-todaypane"
              label="&calendar.tasks.view.filtertasks.label;"
              accesskey="&calendar.tasks.view.filtertasks.accesskey;">
          <menupopup id="task-context-menu-filter-todaypane-popup">
            <menuitem id="task-context-menu-filter-todaypane-current"
                      name="filtergrouptodaypane"
                      value="throughcurrent"
                      type="radio"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.current.label;"
                      accesskey="&calendar.task.filter.current.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-today"
                      name="filtergrouptodaypane"
                      value="throughtoday"
                      type="radio"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.today.label;"
                      accesskey="&calendar.task.filter.today.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-next7days"
                      name="filtergrouptodaypane"
                      value="throughsevendays"
                      type="radio"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.next7days.label;"
                      accesskey="&calendar.task.filter.next7days.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-notstarted"
                      name="filtergrouptodaypane"
                      value="notstarted"
                      type="radio"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.notstarted.label;"
                      accesskey="&calendar.task.filter.notstarted.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-overdue"
                      name="filtergrouptodaypane"
                      value="overdue"
                      type="radio"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.overdue.label;"
                      accesskey="&calendar.task.filter.overdue.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-completed"
                      name="filtergrouptodaypane"
                      type="radio"
                      value="completed"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.completed.label;"
                      accesskey="&calendar.task.filter.completed.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-open"
                      name="filtergrouptodaypane"
                      type="radio"
                      value="open"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.open.label;"
                      accesskey="&calendar.task.filter.open.accesskey;"/>
            <menuitem id="task-context-menu-filter-todaypane-all"
                      name="filtergrouptodaypane"
                      value="all"
                      type="radio"
                      command="calendar_task_filter_todaypane_command"
                      label="&calendar.task.filter.all.label;"
                      accesskey="&calendar.task.filter.all.accesskey;"/>
          </menupopup>
        </menu>
      </menupopup>

      <!-- TASKVIEW LINK CONTEXT MENU -->
      <menupopup id="taskview-link-context-menu">
        <menuitem id="taskview-link-context-menu-copy"
                  label="&calendar.copylink.label;"
                  accesskey="&calendar.copylink.accesskey;"
                  oncommand="taskViewCopyLink(document.popupNode)"/>
      </menupopup>
    </popupset>
  </window>

  <toolbar id="tabbar-toolbar">
    <toolbarbutton id="calendar-tab-button"
                   class="toolbarbutton-1"
                   title="&lightning.toolbar.calendar.label;"
                   tooltiptext="&lightning.toolbar.calendar.tooltip;"
                   command="new_calendar_tab"/>
    <toolbarbutton id="task-tab-button"
                   class="toolbarbutton-1"
                   title="&lightning.toolbar.task.label;"
                   tooltiptext="&lightning.toolbar.task.tooltip;"
                   command="new_task_tab"/>
  </toolbar>

  <tabpanels id="tabpanelcontainer">
    <vbox id="calendarTabPanel">
      <!-- Unfortunately we use the same panel for task and calendar tabs, so
           we need to show one toolbar or the other. -->
      <calendar-modevbox id="calendar-toolbox-container"
                         mode="calendar">
        <toolbox id="calendar-toolbox"
                 class="mail-toolbox"
                 mode="full"
                 defaultmode="full"
                 iconsize="small"
                 defaulticonsize="small"
                 labelalign="end"
                 defaultlabelalign="end">
          <toolbarpalette id="CalendarToolbarPalette">
            <toolbarbutton id="calendar-synchronize-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.sync.label;"
                           tooltiptext="&lightning.toolbar.sync.tooltip;"
                           command="calendar_reload_remote_calendars"/>
            <toolbarbutton id="calendar-newevent-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.newevent.label;"
                           tooltiptext="&lightning.toolbar.newevent.tooltip;"
                           command="calendar_new_event_command"/>
            <toolbarbutton id="calendar-newtask-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.newtask.label;"
                           tooltiptext="&lightning.toolbar.newtask.tooltip;"
                           command="calendar_new_todo_command"/>
            <toolbarbutton id="calendar-goto-today-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.gototoday.label;"
                           tooltiptext="&lightning.toolbar.gototoday.tooltip;"
                           command="calendar_go_to_today_command"/>
            <toolbarbutton id="calendar-edit-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.edit.label;"
                           tooltiptext="&lightning.toolbar.edit.tooltip;"
                           command="calendar_modify_focused_item_command"/>
            <toolbarbutton id="calendar-delete-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.delete.label;"
                           tooltiptext="&lightning.toolbar.delete.tooltip;"
                           command="calendar_delete_focused_item_command"/>
            <toolbarbutton id="calendar-print-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.print.label;"
                           tooltiptext="&lightning.toolbar.print.tooltip;"
                           command="cmd_print"/>
            <toolbarbutton id="calendar-unifinder-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&showUnifinderCmd.label;"
                           tooltiptext="&showUnifinderCmd.tooltip;"
                           command="calendar_show_unifinder_command"/>
            <toolbarbutton id="calendar-appmenu-button"
                           type="menu"
                           class="toolbarbutton-1 button-appmenu"
                           label="&lightning.toolbar.appmenuButton.label;"
                           tooltiptext="&lightning.toolbar.appmenuButton1.tooltip;"/>
          </toolbarpalette>
          <toolbar is="customizable-toolbar" id="calendar-toolbar2"
                   class="inline-toolbar chromeclass-toolbar"
                   toolbarname="&lightning.toolbar.calendar.name;"
                   accesskey="&lightning.toolbar.calendar.name.accesskey;"
                   fullscreentoolbar="true" mode="full"
                   customizable="true"
                   context="calendar-toolbar-context"
                   iconsize="small"
                   defaultset="calendar-synchronize-button,calendar-newevent-button,calendar-newtask-button,calendar-edit-button,calendar-delete-button,spring,calendar-appmenu-button"/>
        </toolbox>
      </calendar-modevbox>

      <calendar-modevbox id="task-toolbox-container"
                         mode="task">
        <toolbox id="task-toolbox"
                 class="mail-toolbox"
                 mode="full"
                 defaultmode="full"
                 iconsize="small"
                 defaulticonsize="small"
                 labelalign="end"
                 defaultlabelalign="end">
          <toolbarpalette id="TaskToolbarPalette">
            <toolbarbutton id="task-synchronize-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.sync.label;"
                           tooltiptext="&lightning.toolbar.sync.tooltip;"
                           command="calendar_reload_remote_calendars"/>
            <toolbarbutton id="task-newevent-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.newevent.label;"
                           tooltiptext="&lightning.toolbar.newevent.tooltip;"
                           command="calendar_new_event_command"/>
            <toolbarbutton id="task-newtask-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.newtask.label;"
                           tooltiptext="&lightning.toolbar.newtask.tooltip;"
                           command="calendar_new_todo_command"/>
            <toolbarbutton id="task-edit-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.edit.label;"
                           tooltiptext="&lightning.toolbar.edit.tooltip;"
                           command="calendar_modify_focused_item_command"/>
            <toolbarbutton id="task-delete-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.delete.label;"
                           tooltiptext="&lightning.toolbar.delete.tooltip;"
                           command="calendar_delete_focused_item_command"/>
            <toolbarbutton id="task-print-button"
                           class="toolbarbutton-1 calbar-toolbarbutton-1"
                           label="&lightning.toolbar.print.label;"
                           tooltiptext="&lightning.toolbar.print.tooltip;"
                           command="cmd_print"/>
            <toolbarbutton id="task-appmenu-button"
                           type="menu"
                           class="toolbarbutton-1 button-appmenu"
                           label="&lightning.toolbar.appmenuButton.label;"
                           tooltiptext="&lightning.toolbar.appmenuButton1.tooltip;"/>
          </toolbarpalette>
          <toolbar is="customizable-toolbar" id="task-toolbar2"
                   class="inline-toolbar chromeclass-toolbar"
                   toolbarname="&lightning.toolbar.task.name;"
                   accesskey="&lightning.toolbar.task.name.accesskey;"
                   fullscreentoolbar="true" mode="full"
                   customizable="true"
                   context="task-toolbar-context"
                   iconsize="small"
                   defaultset="task-synchronize-button,task-newevent-button,task-newtask-button,task-edit-button,task-delete-button,spring,task-appmenu-button"/>
        </toolbox>
      </calendar-modevbox>
      <hbox id="calendarContent" flex="1">
        <vbox id="ltnSidebar"
              width="200"
              persist="collapsed width">
          <calendar-modevbox id="minimonth-pane"
                             mode="calendar,task"
                             refcontrol="calendar_toggle_minimonthpane_command">
            <vbox align="center">
              <hbox id="calMinimonthBox" pack="center">
                <calendar-minimonth id="calMinimonth" onchange="minimonthPick(this.value);"/>
              </hbox>
            </vbox>
          </calendar-modevbox>
          <separator id="minimonth-splitter" minwidth="100"/>
          <vbox id="calendar-panel" flex="1">
            <calendar-modevbox id="task-filter-pane"
                               mode="task"
                               refcontrol="calendar_toggle_filter_command">
              <checkbox id="task-tree-filter-header"
                               checked="true"
                               class="treenode-checkbox"
                               label="&calendar.task.filter.title.label;"/>
              <calendar-modevbox id="task-filtertree-pane"
                                 flex="1"
                                 mode="task"
                                 refcontrol="task-tree-filter-header">
                <radiogroup id="task-tree-filtergroup" class="task-tree-subpane"
                            persist="value">
                  <radio id="opt_throughcurrent_filter" label="&calendar.task.filter.current.label;" value="throughcurrent" command="calendar_task_filter_command"/>
                  <radio id="opt_today_filter" label="&calendar.task.filter.today.label;" value="throughtoday" command="calendar_task_filter_command"/>
                  <radio id="opt_next7days_filter" label="&calendar.task.filter.next7days.label;" value="throughsevendays" command="calendar_task_filter_command"/>
                  <radio id="opt_notstarted_filter" label="&calendar.task.filter.notstarted.label;" value="notstarted" command="calendar_task_filter_command"/>
                  <radio id="opt_overdue_filter" label="&calendar.task.filter.overdue.label;" value="overdue" command="calendar_task_filter_command"/>
                  <radio id="opt_completed_filter" label="&calendar.task.filter.completed.label;" value="completed" command="calendar_task_filter_command"/>
                  <radio id="opt_open_filter" label="&calendar.task.filter.open.label;" value="open" command="calendar_task_filter_command"/>
                  <radio id="opt_all_filter" label="&calendar.task.filter.all.label;" value="all" command="calendar_task_filter_command"/>
                </radiogroup>
              </calendar-modevbox>
            </calendar-modevbox>
            <calendar-modevbox id="calendar-list-pane"
                               flex="1"
                               mode="calendar,task"
                               refcontrol="calendar_toggle_calendarlist_command">
              <checkbox id="calendar-list-header"
                               checked="true"
                               class="treenode-checkbox"
                               label="&calendar.list.header.label;"/>
              <calendar-modevbox id="calendar-list-inner-pane"
                                 flex="1"
                                 mode="calendar,task"
                                 refcontrol="calendar-list-header">
                <richlistbox id="calendar-list" flex="1" context="list-calendars-context-menu"/>
              </calendar-modevbox>
            </calendar-modevbox>
          </vbox>
        </vbox>

        <splitter id="calsidebar_splitter"
                  collapse="before"
                  persist="state"
                  class="calendar-sidebar-splitter"/>

        <deck id="calendarDisplayDeck" flex="1">
          <!-- Events View ("Unifinder") -->
          <vbox id="calendar-view-box" context="calendar-view-context-menu">
            <vbox id="bottom-events-box" insertbefore="calendar-nav-control" persist="height">
              <hbox id="unifinder-searchBox" persist="collapsed">
                <box align="center">
                  <menulist id="event-filter-menulist" value="P7D" persist="value">
                    <menupopup id="event-filter-menupopup" oncommand="refreshEventTree()">
                      <menuitem id="event-filter-all"
                                label="&calendar.events.filter.all.label;"
                                value="all"/>
                      <menuitem id="event-filter-today"
                                label="&calendar.events.filter.today.label;"
                                value="today"/>
                      <menuitem id="event-filter-next7days"
                                label="&calendar.events.filter.next7Days.label;"
                                value="P7D"/>
                      <menuitem id="event-filter-next14Days"
                                label="&calendar.events.filter.next14Days.label;"
                                value="P14D"/>
                      <menuitem id="event-filter-next31Days"
                                label="&calendar.events.filter.next31Days.label;"
                                value="P31D"/>
                      <menuitem id="event-filter-thisCalendarMonth"
                                label="&calendar.events.filter.thisCalendarMonth.label;"
                                value="thisCalendarMonth"/>
                      <menuitem id="event-filter-future"
                                label="&calendar.events.filter.future.label;"
                                value="future"/>
                      <menuitem id="event-filter-current"
                                label="&calendar.events.filter.current.label;"
                                value="current"/>
                      <menuitem id="event-filter-currentview"
                                label="&calendar.events.filter.currentview.label;"
                                value="currentview"/>
                    </menupopup>
                  </menulist>
                </box>
                <box align="center" flex="1">
                  <label control="unifinder-search-field" value="&calendar.search.options.searchfor;"/>
                  <search-textbox id="unifinder-search-field"
                                  class="themeableSearchBox"
                                  oncommand="refreshEventTree();"
                                  flex="1"/>
                </box>
                <toolbarbutton id="unifinder-closer"
                               class="unifinder-closebutton close-icon"
                               command="calendar_show_unifinder_command"
                               tooltiptext="&calendar.unifinder.close.tooltip;"/>
              </hbox>
              <tree id="unifinder-search-results-tree" flex="1"
                    onselect="unifinderSelect(event); calendarController.onSelectionChanged()"
                    onkeypress="unifinderKeyPress(event)"
                    _selectDelay="500"
                    persist="sort-active sort-direction"
                    enableColumnDrag="true">
                <treecols id="unifinder-search-results-tree-cols">
                  <treecol id="unifinder-search-results-tree-col-title"
                           persist="hidden ordinal width"
                           flex="1"
                           itemproperty="title"
                           label="&calendar.unifinder.tree.title.label;"
                           tooltiptext="&calendar.unifinder.tree.title.tooltip2;"/>
                  <splitter class="tree-splitter"/>
                  <treecol id="unifinder-search-results-tree-col-startdate"
                           persist="hidden ordinal width"
                           flex="1"
                           itemproperty="startDate"
                           label="&calendar.unifinder.tree.startdate.label;"
                           tooltiptext="&calendar.unifinder.tree.startdate.tooltip2;"/>
                  <splitter class="tree-splitter"/>
                  <treecol id="unifinder-search-results-tree-col-enddate"
                           persist="hidden ordinal width"
                           flex="1"
                           itemproperty="endDate"
                           label="&calendar.unifinder.tree.enddate.label;"
                           tooltiptext="&calendar.unifinder.tree.enddate.tooltip2;"/>
                  <splitter class="tree-splitter"/>
                  <treecol id="unifinder-search-results-tree-col-categories"
                           persist="hidden ordinal width"
                           flex="1"
                           itemproperty="categories"
                           label="&calendar.unifinder.tree.categories.label;"
                           tooltiptext="&calendar.unifinder.tree.categories.tooltip2;"/>
                  <splitter class="tree-splitter"/>
                  <treecol id="unifinder-search-results-tree-col-location"
                           persist="hidden ordinal width"
                           flex="1"
                           hidden="true"
                           itemproperty="location"
                           label="&calendar.unifinder.tree.location.label;"
                           tooltiptext="&calendar.unifinder.tree.location.tooltip2;"/>
                  <splitter class="tree-splitter"/>
                  <treecol id="unifinder-search-results-tree-col-status"
                           persist="hidden ordinal width"
                           flex="1"
                           hidden="true"
                           itemproperty="status"
                           label="&calendar.unifinder.tree.status.label;"
                           tooltiptext="&calendar.unifinder.tree.status.tooltip2;"/>
                  <treecol id="unifinder-search-results-tree-col-calendarname"
                           persist="hidden ordinal width"
                           flex="1"
                           hidden="true"
                           itemproperty="calendar"
                           label="&calendar.unifinder.tree.calendarname.label;"
                           tooltiptext="&calendar.unifinder.tree.calendarname.tooltip2;"/>
                </treecols>

                <!-- on mousedown here happens before onclick above -->
                <treechildren tooltip="eventTreeTooltip"
                              context="calendar-item-context-menu"
                              onkeypress="if (event.key == 'Enter') { unifinderEditCommand(); }"
                              ondragenter="return false;"
                              ondblclick="unifinderDoubleClick(event)"
                              onfocus="focusFirstItemIfNoSelection();"/>
              </tree>
            </vbox>
            <splitter id="calendar-view-splitter"
                      insertbefore="calendar-nav-control"
                      resizebefore="closest"
                      resizeafter="farthest"
                      persist="state"
                      class="chromeclass-extrachrome sidebar-splitter calendar-splitter"
                      orient="vertical"
                      onmouseup="setTimeout(refreshEventTree, 10);"/>

            <!-- Calendar Views -->
            <hbox id="calendar-nav-control">
              <vbox flex="1">
                <hbox flex="1" class="navigation-inner-box" align="center">
                  <!-- If you are extending a view, add attributes to these
                       nodes for your view. i.e if your view has the id
                       "foobar-view", then you need to add the attribute
                       tooltiptext-foobar="..." -->
                  <hbox pack="center">
                    <toolbarbutton id="previous-view-button"
                                   class="view-navigation-button"
                                   type="prev"
                                   tooltiptext-day="&calendar.navigation.prevday.tooltip;"
                                   tooltiptext-week="&calendar.navigation.prevweek.tooltip;"
                                   tooltiptext-multiweek="&calendar.navigation.prevweek.tooltip;"
                                   tooltiptext-month="&calendar.navigation.prevmonth.tooltip;"
                                   command="calendar_view_prev_command"/>
                    <toolbarbutton id="today-view-button"
                                   class="today-navigation-button"
                                   label="&calendar.today.button.label;"
                                   tooltiptext-all="&calendar.today.button.tooltip;"
                                   command="calendar_view_today_command"/>
                    <toolbarbutton id="next-view-button"
                                   class="view-navigation-button"
                                   type="next"
                                   tooltiptext-day="&calendar.navigation.nextday.tooltip;"
                                   tooltiptext-week="&calendar.navigation.nextweek.tooltip;"
                                   tooltiptext-multiweek="&calendar.navigation.nextweek.tooltip;"
                                   tooltiptext-month="&calendar.navigation.nextmonth.tooltip;"
                                   command="calendar_view_next_command"/>
                  </hbox>
                  <label id="intervalDescription"
                         class="view-header"
                         crop="end"
                         flex="1"
                         pack="start"/>
                  <spacer flex="1"/>
                  <label id="calendarWeek"
                         class="view-header"
                         type="end"
                         crop="start"/>
                </hbox>
                <hbox flex="1" class="navigation-bottombox"/>
              </vbox>
              <vbox id="view-tabbox" pack="end">
                <radiogroup id="view-tabs"
                            class="calview-tabs"
                            orient="horizontal">
                  <radio id="calendar-day-view-button"
                         label="&calendar.day.button.label;"
                         tooltiptext="&calendar.day.button.tooltip;"
                         class="calview"
                         command="calendar_day-view_command"/>
                  <radio id="calendar-week-view-button"
                         label="&calendar.week.button.label;"
                         tooltiptext="&calendar.week.button.tooltip;"
                         class="calview"
                         command="calendar_week-view_command"/>
                  <radio id="calendar-multiweek-view-button"
                         label="&calendar.multiweek.button.label;"
                         tooltiptext="&calendar.multiweek.button.tooltip;"
                         class="calview"
                         command="calendar_multiweek-view_command"/>
                  <radio id="calendar-month-view-button"
                         label="&calendar.month.button.label;"
                         tooltiptext="&calendar.month.button.tooltip;"
                         class="calview"
                         command="calendar_month-view_command"/>
                </radiogroup>
                <box class="navigation-bottombox"/>
              </vbox>
              <vbox>
                <vbox flex="1" class="navigation-spacer-box"/>
                <hbox class="navigation-bottombox"/>
              </vbox>
            </hbox>
            <deck flex="1"
                  id="view-deck"
                  persist="selectedIndex">
              <!-- Note: the "id" attributes of the calendar panes **must** follow the
                   notation 'type + "-" + "view"', where "type" should refer to the
                   displayed time period as described in base/public/calICalendarView.idl -->
              <calendar-day-view id="day-view" flex="1"
                                 context="calendar-view-context-menu"
                                 item-context="calendar-item-context-menu"/>
              <calendar-week-view id="week-view" flex="1"
                                  context="calendar-view-context-menu"
                                  item-context="calendar-item-context-menu"/>
              <calendar-multiweek-view id="multiweek-view" flex="1"
                                       context="calendar-view-context-menu"
                                       item-context="calendar-item-context-menu"/>
              <calendar-month-view id="month-view" flex="1"
                                   context="calendar-view-context-menu"
                                   item-context="calendar-item-context-menu"/>
            </deck>
          </vbox>
          <!-- Tasks View -->
          <vbox id="calendar-task-box" flex="1"
                onselect="taskDetailsView.onSelect(event);">
            <hbox id="task-addition-box" align="center">
              <box align="center" flex="1">
                <toolbarbutton id="calendar-add-task-button"
                               label="&calendar.newtask.button.label;"
                               tooltiptext="&calendar.newtask.button.tooltip;"
                               command="calendar_new_todo_command"/>
                <hbox align="center" flex="1" class="input-container">
                  <html:input id="view-task-edit-field"
                              class="task-edit-field themeableSearchBox"
                              onfocus="taskEdit.onFocus(event)"
                              onblur="taskEdit.onBlur(event)"
                              onkeypress="taskEdit.onKeyPress(event)"/>
                </hbox>
              </box>
              <box align="center" flex="1">
                <search-textbox id="task-text-filter-field"
                                class="themeableSearchBox"
                                flex="1"
                                placeholder=""
                                emptytextbase="&calendar.task.text-filter.textbox.emptytext.base1;"
                                keyLabelNonMac="&calendar.task.text-filter.textbox.emptytext.keylabel.nonmac;"
                                keyLabelMac="&calendar.task.text-filter.textbox.emptytext.keylabel.mac;"
                                oncommand="taskViewUpdate();"/>
              </box>
            </hbox>
            <vbox flex="1">
              <tree is="calendar-task-tree" id="calendar-task-tree"
                    flex="1"
                    visible-columns="completed priority title entryDate dueDate"
                    persist="visible-columns ordinals widths sort-active sort-direction height"
                    context="taskitem-context-menu"/>
              <splitter id="calendar-task-view-splitter" collapse="none" persist="state" class="calendar-splitter"/>
              <vbox id="calendar-task-details-container"
                    class="main-header-area"
                    flex="1"
                    persist="height"
                    hidden="true">
                <hbox id="calendar-task-details">
                  <hbox id="other-actions-box">
                    <vbox id="task-actions-toolbox">
                      <hbox id="task-actions-toolbar" class="toolbar">
                        <toolbarbutton id="task-actions-category"
                                       type="menu"
                                       label="&calendar.unifinder.tree.categories.label;"
                                       tooltiptext="&calendar.task.category.button.tooltip;"
                                       command="calendar_task_category_command"
                                       class="toolbarbutton-1 msgHeaderView-button">
                          <menupopup id="task-actions-category-popup"
                                     onpopupshowing="taskDetailsView.loadCategories(event);"
                                     onpopuphiding="return taskDetailsView.saveCategories(event);">
                            <html:input id="task-actions-category-textbox"
                                        placeholder="&event.categories.textbox.label;"
                                        onblur="this.parentNode.removeAttribute(&quot;ignorekeys&quot;);"
                                        onfocus="this.parentNode.setAttribute(&quot;ignorekeys&quot;, &quot;true&quot;);"
                                        onkeypress="taskDetailsView.categoryTextboxKeypress(event);"/>
                            <menuseparator/>
                          </menupopup>
                        </toolbarbutton>
                        <toolbarbutton is="toolbarbutton-menu-button" id="task-actions-markcompleted"
                                       type="menu-button"
                                       label="&calendar.context.markcompleted.label;"
                                       tooltiptext="&calendar.task.complete.button.tooltip;"
                                       command="calendar_toggle_completed_command"
                                       class="toolbarbutton-1 msgHeaderView-button">
                          <menupopup is="calendar-task-progress-menupopup" id="task-actions-markcompleted-menupopup"/>
                        </toolbarbutton>
                        <toolbarbutton id="task-actions-priority"
                                       type="menu"
                                       label="&calendar.context.priority.label;"
                                       tooltiptext="&calendar.task.priority.button.tooltip;"
                                       command="calendar_general-priority_command"
                                       class="toolbarbutton-1 msgHeaderView-button">
                          <menupopup is="calendar-task-priority-menupopup" id="task-actions-priority-menupopup"/>
                        </toolbarbutton>
                        <toolbarbutton id="calendar-delete-task-button"
                                       class="toolbarbutton-1 msgHeaderView-button"
                                       label="&calendar.taskview.delete.label;"
                                       tooltiptext="&calendar.context.deletetask.label;"
                                       command="calendar_delete_todo_command"/>
                      </hbox>
                    </vbox>
                  </hbox>
                  <hbox id ="calendar-task-details-box">
                    <html:table id="calendar-task-details-grid">
                      <html:tr id="calendar-task-details-title-row"
                               hidden="hidden">
                        <html:th class="task-details-name">
                          &calendar.task-details.title.label;
                        </html:th>
                        <html:td id="calendar-task-details-title"
                                 class="task-details-value">
                        </html:td>
                      </html:tr>
                      <html:tr id="calendar-task-details-priority-row"
                               hidden="hidden">
                        <html:th id="calendar-task-details-priority-label"
                                 class="task-details-name">
                          &calendar.task-details.priority.label;
                        </html:th>
                        <html:td id="calendar-task-details-priority-td">
                          <label id="calendar-task-details-priority-low"
                                 value="&calendar.task-details.priority.low.label;"
                                 class="task-details-value"
                                 hidden="true"/>
                          <label id="calendar-task-details-priority-normal"
                                 value="&calendar.task-details.priority.normal.label;"
                                 class="task-details-value"
                                 hidden="true"/>
                          <label id="calendar-task-details-priority-high"
                                 value="&calendar.task-details.priority.high.label;"
                                 class="task-details-value"
                                 hidden="true"/>
                        </html:td>
                      </html:tr>
                      <html:tr id="calendar-task-details-organizer-row"
                               hidden="hidden">
                        <html:th class="task-details-name">
                          &calendar.task-details.organizer.label;
                        </html:th>
                        <html:td id="calendar-task-details-organizer"
                                 class="task-details-value text-link"
                                 onclick="sendMailToOrganizer()">
                        </html:td>
                      </html:tr>
                      <html:tr id="calendar-task-details-status-row"
                               hidden="hidden">
                        <html:th class="task-details-name">
                          &calendar.task-details.status.label;
                        </html:th>
                        <html:td id="calendar-task-details-status"
                                 class="task-details-value">
                        </html:td>
                      </html:tr>
                      <html:tr id="calendar-task-details-category-row"
                               hidden="hidden">
                        <html:th class="task-details-name">
                          &calendar.task-details.category.label;
                        </html:th>
                        <html:td id="calendar-task-details-category"
                                 class="task-details-value">
                        </html:td>
                      </html:tr>
                      <html:tr id="task-start-row"
                               class="item-date-row"
                               hidden="hidden">
                        <html:th class="headline"
                                 control="task-start-date">
                          &calendar.task-details.start.label;
                        </html:th>
                        <html:td>
                          <html:input is="calendar-item-date-input" id="task-start-date" mode="start"/>
                        </html:td>
                      </html:tr>
                      <html:tr id="task-due-row"
                               class="item-date-row"
                               hidden="hidden">
                        <html:th class="headline"
                                 control="task-due-date">
                          &calendar.task-details.due.label;
                        </html:th>
                        <html:td>
                          <html:input is="calendar-item-date-input" id="task-due-date" mode="end"/>
                        </html:td>
                      </html:tr>
                      <html:tr id="calendar-task-details-repeat-row"
                               hidden="hidden">
                        <html:th class="task-details-name">
                          &calendar.task-details.repeat.label;
                        </html:th>
                        <html:td id="calendar-task-details-repeat"
                                 class="task-details-value">
                        </html:td>
                      </html:tr>
                    </html:table>
                  </hbox>
                </hbox>
                <hbox id="calendar-task-details-description-wrapper" flex="1">
                  <html:textarea id="calendar-task-details-description"/>
                </hbox>
                <hbox id="calendar-task-details-attachment-row"
                      align="top"
                      hidden="true">
                  <hbox pack="end">
                    <label value="&calendar.task-details.attachments.label;"
                           class="task-details-name"/>
                  </hbox>
                  <vbox id="calendar-task-details-attachment-rows"
                        align="top"
                        flex="1"
                        style="overflow: auto;"
                        hidden="true">
                  </vbox>
                </hbox>
              </vbox>
            </vbox>
          </vbox>
        </deck>
      </hbox>
    </vbox>
  </tabpanels>

  <!-- Today Pane -->
  <hbox id="tabmail-container">
    <splitter id="today-splitter"
              collapse="after"
              resizebefore="closest"
              state="collapsed"
              class="calendar-sidebar-splitter"
              oncommand="TodayPane.onCommandTodaySplitter();">
    </splitter>
    <calendar-modevbox id="today-pane-panel"
                       mode="mail,calendar,task,chat"
                       modewidths="200,200,200,200"
                       modesplitterstates="open,open,open,open"
                       refcontrol="calendar_toggle_todaypane_command"
                       persist="modewidths">
      <box class="sidebar-header" align="center">
        <label id="today-pane-header"/>
        <spacer flex="1"/>
        <calendar-modebox mode="mail,calendar,chat">
          <toolbarbutton id="today-pane-cycler-prev"
                         dir="prev"
                         class="today-pane-cycler"
                         oncommand="TodayPane.cyclePaneView(-1);"/>
          <toolbarbutton id="today-pane-cycler-next"
                         dir="next"
                         class="today-pane-cycler"
                         oncommand="TodayPane.cyclePaneView(1);"/>
        </calendar-modebox>
        <spacer id="buttonspacer"/>
        <toolbarbutton id="today-closer" class="today-closebutton close-icon"
                       oncommand="document.getElementById('today-pane-panel').setVisible(false, true, true);
                                  TodayPane.updateDisplay();
                                  TodayPane.updateSplitterState();"/>
      </box>
      <vbox flex="1">
        <calendar-modevbox id="agenda-panel"
                           flex="1"
                           mode="mail,calendar,task,chat"
                           collapsedinmodes="calendar"
                           persist="collapsed height collapsedinmodes">
          <calendar-modebox id="today-none-box"
                            mode="mail,calendar,task,chat"
                            collapsedinmodes="mail,calendar,task,chat"
                            refcontrol="ltnTodayPaneDisplayNone"
                            persist="collapsedinmodes"/>
          <calendar-modebox id="today-minimonth-box"
                            pack="center"
                            class="today-subpane"
                            mode="mail,calendar,task,chat"
                            collapsedinmodes="mail,calendar,task,chat"
                            refcontrol="ltnTodayPaneDisplayMinimonth"
                            persist="collapsedinmodes">
            <calendar-minimonth id="today-minimonth"
                                onchange="TodayPane.setDaywithjsDate(this.value);"/>
          </calendar-modebox>
          <calendar-modebox id="mini-day-box"
                            mode="mail,calendar,task,chat"
                            class="today-subpane"
                            refcontrol="ltnTodayPaneDisplayMiniday"
                            collapsedinmodes=""
                            persist="collapsedinmodes"
                            onDOMMouseScroll="TodayPane.advance(event.detail > 0 ? 1 : -1);">
            <stack flex="1">
              <image id="mini-day-image" flex="1"/>
              <hbox flex="1">
                <stack id="dateContainer">
                  <hbox pack="center"
                        align="center">
                    <label id="datevalue-label" class="dateValue"
                           ondblclick="TodayPane.onDoubleClick(event);"
                           onmousedown="TodayPane.onMousedown(event);"/>
                  </hbox>
                  <hbox flex="1" pack="center" align="center" mousethrough="always">
                    <image id="dragCenter-image" hidden="true"/>
                  </hbox>
                </stack>
                <vbox flex="1">
                  <hbox pack="center">
                    <deck id="weekdayNameContainer" pack="center"
                          ondblclick="TodayPane.onDoubleClick(event);">
                      <label/>
                      <label/>
                      <label/>
                      <label/>
                      <label/>
                      <label/>
                      <label/>
                    </deck>
                    <spacer id="weekspacer" flex="1"/>
                    <hbox pack="end">
                      <toolbarbutton id="previous-day-button"
                                     class="miniday-nav-buttons"
                                     tooltiptext="&onedaybackward.tooltip;"
                                     onmousedown="TodayPane.onMousedown(event, -1);"
                                     dir="-1"/>
                      <toolbarbutton id="today-button"
                                     class="miniday-nav-buttons"
                                     tooltiptext="&showToday.tooltip;"
                                     oncommand="TodayPane.setDay(cal.dtz.now());"/>
                      <toolbarbutton id="next-day-button"
                                     class="miniday-nav-buttons"
                                     tooltiptext="&onedayforward.tooltip;"
                                     onmousedown="TodayPane.onMousedown(event, 1);"
                                     dir="1"/>
                    </hbox>
                  </hbox>
                  <hbox pack="start">
                    <label id="monthNameContainer" class="monthlabel"
                           ondblclick="TodayPane.onDoubleClick(event);"/>
                    <label id="currentWeek-label" class="monthlabel"
                           ondblclick="TodayPane.onDoubleClick(event);"/>
                    <spacer flex="1"/>
                  </hbox>
                </vbox>
                <toolbarbutton id="miniday-dropdown-button"
                               tooltiptext="&showselectedday.tooltip;"
                               type="menu">
                  <panel id="miniday-month-panel" position="after_end"
                         onpopupshown="this.firstElementChild.focusCalendar();">
                    <calendar-minimonth id="miniday-dropdown-minimonth"
                                        flex="1"
                                        onchange="TodayPane.setDaywithjsDate(this.value);
                                                  document.getElementById('miniday-month-panel').hidePopup();"/>
                  </panel>
                </toolbarbutton>
              </hbox>
            </stack>
          </calendar-modebox>
          <vbox flex="1">
            <hbox id="agenda-toolbar" iconsize="small">
              <toolbarbutton id="todaypane-new-event-button"
                             mode="mail"
                             iconsize="small"
                             orient="horizontal"
                             label="&calendar.newevent.button.label;"
                             tooltiptext="&calendar.newevent.button.tooltip;"
                             command="calendar_new_event_todaypane_command"/>
            </hbox>
            <richlistbox id="agenda-listbox" flex="1" context="_child"
                         onblur="agendaListbox.onBlur();"
                         onfocus="agendaListbox.onFocus();"
                         onkeypress="agendaListbox.onKeyPress(event);"
                         ondblclick="agendaListbox.createNewEvent(event);"
                         ondragstart="nsDragAndDrop.startDrag(event, calendarCalendarButtonDNDObserver);"
                         ondragover="nsDragAndDrop.dragOver(event, calendarCalendarButtonDNDObserver);"
                         ondrop="nsDragAndDrop.drop(event, calendarCalendarButtonDNDObserver);">
              <menupopup id="agenda-menupopup" onpopupshowing="return agendaListbox.setupContextMenu(event.target)">
                <menuitem label="&calendar.context.modifyorviewitem.label;"
                          accesskey="&calendar.context.modifyorviewitem.accesskey;"
                          command="agenda_edit_event_command"/>
                <menu id="agenda-context-menu-convert-menu"
                      label="&calendar.context.convertmenu.label;"
                      accesskey="&calendar.context.convertmenu.accesskey.calendar;">
                  <menupopup id="agenda-context-menu-convert-menupopup">
                    <menuitem id="agenda-context-menu-convert-message-menuitem"
                              label="&calendar.context.convertmenu.message.label;"
                              accesskey="&calendar.context.convertmenu.message.accesskey;"
                              oncommand="calendarMailButtonDNDObserver.onDropItems(agendaListbox.getSelectedItems())"/>
                    <menuitem id="agenda-context-menu-convert-task-menuitem"
                              class="event-only"
                              label="&calendar.context.convertmenu.task.label;"
                              accesskey="&calendar.context.convertmenu.task.accesskey;"
                              oncommand="calendarTaskButtonDNDObserver.onDropItems(agendaListbox.getSelectedItems())"/>
                  </menupopup>
                </menu>
                <menuseparator id="calendar-today-pane-menuseparator-before-delete"/>
                <menuitem label="&calendar.context.deleteevent.label;"
                          accesskey="&calendar.context.deleteevent.accesskey;"
                          key="calendar-delete-item-key"
                          command="agenda_delete_event_command"/>
                <menu id="calendar-today-pane-menu-attendance-menu"
                      label="&calendar.context.attendance.menu.label;"
                      accesskey="&calendar.context.attendance.menu.accesskey;"
                      oncommand="setContextPartstat(event.target, agendaListbox.getSelectedItems({}))"
                      observes="calendar_attendance_command">
                  <menupopup id="agenda-context-menu-attendance-menupopup">
                    <label id="agenda-context-attendance-thisoccurrence-label"
                           class="calendar-context-heading-label"
                           scope="this-occurrence"
                           value="&calendar.context.attendance.occurrence.label;"/>
                    <menu id="agenda-context-menu-attendance-accepted-menu"
                          label="&calendar.context.attendance.occ.accepted.label;"
                          accesskey="&calendar.context.attendance.occ.accepted.accesskey;"
                          value="ACCEPTED"
                          name="agenda-context-attendance"
                          scope="this-occurrence">
                      <menupopup id="agenda-context-menu-occurrence-accepted-menupopup">
                        <menuitem id="agenda-context-menu-attend-accept-menuitem"
                                  scope="this-occurrence"
                                  label="&calendar.context.attendance.send.label;"
                                  accesskey="&calendar.context.attendance.send.accesskey;"
                                  respvalue="ACCEPTED"
                                  respmode="AUTO"/>
                        <menuitem id="agenda-context-menu-attend-accept-dontsend-menuitem"
                                  scope="this-occurrence"
                                  label="&calendar.context.attendance.dontsend.label;"
                                  accesskey="&calendar.context.attendance.dontsend.accesskey;"
                                  respvalue="ACCEPTED"
                                  respmode="NONE"/>
                      </menupopup>
                    </menu>
                    <menu id="agenda-context-menu-attendance-tentative-menu"
                          label="&calendar.context.attendance.occ.tentative.label;"
                          accesskey="&calendar.context.attendance.occ.tentative.accesskey;"
                          value="TENTATIVE"
                          name="agenda-context-attendance"
                          scope="this-occurrence">
                      <menupopup id="agenda-context-menu-occurrence-tentative-menupopup">
                        <menuitem id="agenda-context-menu-attend-tentative-menuitem"
                                  scope="this-occurrence"
                                  label="&calendar.context.attendance.send.label;"
                                  accesskey="&calendar.context.attendance.send.accesskey;"
                                  respvalue="TENTATIVE"
                                  respmode="AUTO"/>
                        <menuitem id="agenda-context-menu-attend-tentative-dontsend-menuitem"
                                  scope="this-occurrence"
                                  label="&calendar.context.attendance.dontsend.label;"
                                  accesskey="&calendar.context.attendance.dontsend.accesskey;"
                                  respvalue="TENTATIVE"
                                  respmode="NONE"/>
                      </menupopup>
                    </menu>
                    <menu id="agenda-context-menu-attendance-declined-menu"
                          label="&calendar.context.attendance.occ.declined.label;"
                          accesskey="&calendar.context.attendance.occ.declined.accesskey;"
                          value="DECLINED"
                          name="agenda-context-attendance"
                          scope="this-occurrence">
                      <menupopup id="agenda-context-menu-occurrence-tentative-menupopup">
                        <menuitem id="agenda-context-menu-attend-declined-menuitem"
                                  scope="this-occurrence"
                                  label="&calendar.context.attendance.send.label;"
                                  accesskey="&calendar.context.attendance.send.accesskey;"
                                  respvalue="DECLINED"
                                  respmode="AUTO"/>
                        <menuitem id="agenda-context-menu-attend-declined-dontsend-menuitem"
                                  scope="this-occurrence"
                                  label="&calendar.context.attendance.dontsend.label;"
                                  accesskey="&calendar.context.attendance.dontsend.accesskey;"
                                  respvalue="DECLINED"
                                  respmode="NONE"/>
                      </menupopup>
                    </menu>
                    <menuitem id="agenda-context-menu-attendance-delegated-menu"
                              label="&calendar.context.attendance.occ.delegated.label;"
                              name="agenda-context-attendance"
                              scope="this-occurrence"
                              value="DELEGATED"/>
                    <menuitem id="agenda-context-menu-attendance-needsaction-menu"
                              label="&calendar.context.attendance.occ.needsaction.label;"
                              name="agenda-context-attendance"
                              scope="this-occurrence"
                              value="NEEDS-ACTION"/>
                    <label id="agenda-context-attendance-alloccurrence-label"
                           class="calendar-context-heading-label"
                           scope="all-occurrences"
                           value="&calendar.context.attendance.all2.label;"/>
                    <menu id="agenda-context-menu-attendance-accepted-all-menu"
                          label="&calendar.context.attendance.all.accepted.label;"
                          accesskey="&calendar.context.attendance.all.accepted.accesskey;"
                          value="ACCEPTED"
                          name="agenda-context-attendance-all"
                          scope="all-occurrences">
                      <menupopup id="agenda-context-menu-alloccurrences-accept-menupopup">
                        <menuitem id="agenda-context-menu-attend-accept-all-menuitem"
                                  scope="all-occurrences"
                                  label="&calendar.context.attendance.send.label;"
                                  accesskey="&calendar.context.attendance.send.accesskey;"
                                  respvalue="ACCEPTED"
                                  respmode="AUTO"/>
                        <menuitem id="agenda-context-menu-attend-accept-all-dontsend-menuitem"
                                  scope="all-occurrences"
                                  label="&calendar.context.attendance.dontsend.label;"
                                  accesskey="&calendar.context.attendance.dontsend.accesskey;"
                                  respvalue="ACCEPTED"
                                  respmode="NONE"/>
                      </menupopup>
                    </menu>
                    <menu id="agenda-context-menu-attendance-tentative-all-menu"
                          label="&calendar.context.attendance.all.tentative.label;"
                          accesskey="&calendar.context.attendance.all.tentative.accesskey;"
                          value="TENTATIVE"
                          name="agenda-context-attendance-all"
                          scope="all-occurrences">
                      <menupopup id="agenda-context-menu-alloccurrences-tentative-menupopup">
                        <menuitem id="agenda-context-menu-attend-tentative-all-menuitem"
                                  scope="all-occurrences"
                                  label="&calendar.context.attendance.send.label;"
                                  accesskey="&calendar.context.attendance.send.accesskey;"
                                  respvalue="TENTATIVE"
                                  respmode="AUTO"/>
                        <menuitem id="agenda-context-menu-attend-tentative-all-dontsend-menuitem"
                                  scope="all-occurrences"
                                  label="&calendar.context.attendance.dontsend.label;"
                                  accesskey="&calendar.context.attendance.dontsend.accesskey;"
                                  respvalue="TENTATIVE"
                                  respmode="NONE"/>
                      </menupopup>
                    </menu>
                    <menu id="agenda-context-menu-attendance-decline-all-menu"
                          label="&calendar.context.attendance.all.declined.label;"
                          accesskey="&calendar.context.attendance.all.declined.accesskey;"
                          value="DECLINED"
                          name="agenda-context-attendance-all"
                          scope="all-occurrences">
                      <menupopup id="agenda-context-menu-alloccurrences-decline-menupopup">
                        <menuitem id="agenda-context-menu-attend-declined-all-menuitem"
                                  scope="all-occurrences"
                                  label="&calendar.context.attendance.send.label;"
                                  accesskey="&calendar.context.attendance.send.accesskey;"
                                  respvalue="DECLINED"
                                  respmode="AUTO"/>
                        <menuitem id="agenda-context-menu-attend-declined-all-dontsend-menuitem"
                                  scope="all-occurrences"
                                  label="&calendar.context.attendance.dontsend.label;"
                                  accesskey="&calendar.context.attendance.dontsend.accesskey;"
                                  respvalue="DECLINED"
                                  respmode="NONE"/>
                      </menupopup>
                    </menu>
                    <menuitem id="agenda-context-menu-attendance-delegated-all-menu"
                              label="&calendar.context.attendance.all.delegated.label;"
                              name="agenda-context-attendance-delegated-all"
                              scope="all-occurrences"
                              value="DELEGATED"/>
                    <menuitem id="agenda-context-menu-attendance-needsaction-all-menu"
                              label="&calendar.context.attendance.all.needsaction.label;"
                              name="agenda-context-attendance-needaction-all"
                              scope="all-occurrences"
                              value="NEEDS-ACTION"/>
                  </menupopup>
                </menu>
              </menupopup>
              <richlistitem is="agenda-header-richlistitem" id="today-header"
                            class="agenda-header-richlistitem"
                            title="&calendar.today.button.label;"
                            checked="true"
                            persist="checked"/>
              <richlistitem is="agenda-header-richlistitem" id="tomorrow-header"
                            class="agenda-header-richlistitem"
                            title="&calendar.tomorrow.button.label;"
                            checked="false"
                            persist="checked"/>
              <richlistitem is="agenda-header-richlistitem" id="nextweek-header"
                            class="agenda-header-richlistitem"
                            title="&calendar.upcoming.button.label;"
                            checked="false"
                            persist="checked"/>
            </richlistbox>
          </vbox>
        </calendar-modevbox>
        <splitter id="today-pane-splitter" persist="hidden"/>
        <calendar-modevbox id="todo-tab-panel"
                           flex="1"
                           mode="mail,calendar,chat"
                           collapsedinmodes="mail,task,chat"
                           persist="height collapsedinmodes"
                           ondragstart="nsDragAndDrop.startDrag(event, calendarTaskButtonDNDObserver);"
                           ondragover="nsDragAndDrop.dragOver(event, calendarTaskButtonDNDObserver);"
                           ondrop="nsDragAndDrop.drop(event, calendarTaskButtonDNDObserver);">
          <!-- This second vbox means all of this is added to the DOM at once,
               so the label's binding doesn't complain about not having a control. -->
          <vbox flex="1">
            <box id="show-completed-checkbox-box" align="center">
              <checkbox id="show-completed-checkbox"
                        label="&calendar.unifinder.showcompletedtodos.label;"
                        flex="1"
                        crop="end"
                        oncommand="TodayPane.updateCalendarToDoUnifinder()"
                        persist="checked"
                        autocheck="false"/>
            </box>
            <vbox id="calendar-task-tree-detail" flex="1">
              <tree is="calendar-task-tree-todaypane" id="unifinder-todo-tree"
                    flex="1"
                    visible-columns="completed priority title"
                    persist="visible-columns ordinals widths sort-active sort-direction filterValue"
                    context="taskitem-context-menu"/>
              <html:input id="unifinder-task-edit-field"
                          class="task-edit-field themeableSearchBox"
                          onfocus="taskEdit.onFocus(event)"
                          onblur="taskEdit.onBlur(event)"
                          onkeypress="taskEdit.onKeyPress(event)"/>
            </vbox>
          </vbox>
        </calendar-modevbox>
      </vbox>
    </calendar-modevbox>
  </hbox>

  <hbox id="status-bar">
    <!-- event/task in tab statusbarpanels -->
    <hbox id="status-privacy"
          class="statusbarpanel event-dialog"
          align="center"
          flex="1"
          collapsed="true"
          pack="start">
      <label value="&event.statusbarpanel.privacy.label;"/>
      <hbox id="status-privacy-public-box" privacy="PUBLIC">
        <label value="&event.menu.options.privacy.public.label;"/>
      </hbox>
      <hbox id="status-privacy-confidential-box" privacy="CONFIDENTIAL">
        <label value="&event.menu.options.privacy.confidential.label;"/>
      </hbox>
      <hbox id="status-privacy-private-box" privacy="PRIVATE">
        <label value="&event.menu.options.privacy.private.label;"/>
      </hbox>
    </hbox>
    <hbox id="status-priority"
          class="statusbarpanel event-dialog"
          align="center"
          flex="1"
          collapsed="true"
          pack="start">
      <label value="&event.priority2.label;"/>
      <image id="image-priority-low"
             class="cal-statusbar-1"
             collapsed="true"
             value="low"/>
      <image id="image-priority-normal"
             class="cal-statusbar-1"
             collapsed="true"
             value="normal"/>
      <image id="image-priority-high"
             class="cal-statusbar-1"
             collapsed="true"
             value="high"/>
    </hbox>
    <hbox id="status-status"
          class="statusbarpanel event-dialog"
          align="center"
          flex="1"
          collapsed="true"
          pack="start">
      <label value="&task.status.label;"/>
      <label id="status-status-tentative-label"
             value="&newevent.status.tentative.label;"
             hidden="true"/>
      <label id="status-status-confirmed-label"
             value="&newevent.status.confirmed.label;"
             hidden="true"/>
      <label id="status-status-cancelled-label"
             value="&newevent.eventStatus.cancelled.label;"
             hidden="true"/>
    </hbox>
    <hbox id="status-freebusy"
          class="statusbarpanel event-only event-dialog"
          align="center"
          flex="1"
          collapsed="true"
          pack="start">
      <label value="&event.statusbarpanel.freebusy.label;"/>
      <label id="status-freebusy-free-label"
             value="&event.freebusy.legend.free;"
             hidden="true"/>
      <label id="status-freebusy-busy-label"
             value="&event.freebusy.legend.busy;"
             hidden="true"/>
    </hbox>
    <!-- end event/task in tab statusbarpanels -->
    <calendar-modebox id="calendar-show-todaypane-panel"
                      class="statusbarpanel"
                      mode="mail,calendar,task,chat"
                      collapsedinmodes="special"
                      pack="center">
      <toolbarbutton id="calendar-status-todaypane-button"
                     type="checkbox"
                     label="&todaypane.statusButton.label;"
                     tooltiptext="&calendar.todaypane.button.tooltip;"
                     command="calendar_toggle_todaypane_command"/>
    </calendar-modebox>
    <hbox id="calendar-invitations-panel"
          class="statusbarpanel"
          insertbefore="unreadMessageCount,totalMessageCount"
          oncommand="openInvitationsDialog()">
      <label id="calendar-invitations-label"
             class="text-link"
             onclick="openInvitationsDialog()"
             onkeypress="if (event.key == 'Enter') { openInvitationsDialog(); }"/>
    </hbox>
  </hbox>

  <!-- CALENDAR TOOLBAR BUTTONS FOR MAIL TOOLBAR -->
  <toolbarpalette id="MailToolbarPalette">
    <toolbarbutton id="lightning-button-calendar"
                   class="toolbarbutton-1"
                   label="&lightning.toolbar.calendar.label;"
                   tooltiptext="&lightning.toolbar.calendar.tooltip;"
                   command="new_calendar_tab"/>
    <toolbarbutton id="lightning-button-tasks"
                   class="toolbarbutton-1"
                   label="&lightning.toolbar.task.label;"
                   tooltiptext="&lightning.toolbar.task.tooltip;"
                   command="new_task_tab"/>
    <toolbarbutton is="toolbarbutton-menu-button" id="extractEventButton"
                   type="menu-button"
                   class="toolbarbutton-1"
                   label="&calendar.extract.event.button;"
                   tooltiptext="&calendar.extract.event.button.tooltip;"
                   oncommand="calendarExtract.extractFromEmail(true);">
      <menupopup id="extractEventLocaleList"
                 oncommand="calendarExtract.extractWithLocale(event, true);"
                 onpopupshowing="calendarExtract.onShowLocaleMenu(event.target);"/>
    </toolbarbutton>
    <toolbarbutton is="toolbarbutton-menu-button" id="extractTaskButton"
                   type="menu-button"
                   class="toolbarbutton-1"
                   label="&calendar.extract.task.button;"
                   tooltiptext="&calendar.extract.task.button.tooltip;"
                   oncommand="calendarExtract.extractFromEmail(false);">
      <menupopup id="extractTaskLocaleList"
                 oncommand="calendarExtract.extractWithLocale(event, false);"
                 onpopupshowing="calendarExtract.onShowLocaleMenu(event.target);"/>
    </toolbarbutton>
  </toolbarpalette>

  <!-- CALENDAR MENUS -->
  <menupopup id="menu_FilePopup">
    <menu id="menu_Open"
          mode="calendar"
          label="&lightning.menupopup.open.label;"
          accesskey="&lightning.menupopup.open.accesskey;"
          insertafter="menu_New">
      <menupopup id="menu_OpenPopup">
        <menuitem id="ltnOpenMessageFileMenuitem"
                  label="&lightning.menupopup.open.message.label;"
                  accesskey="&lightning.menupopup.open.message.accesskey;"
                  oncommand="MsgOpenFromFile();"/>
        <menuitem id="ltnOpenCalendarFileMenuitem"
                  label="&lightning.menupopup.open.calendar.label;"
                  accesskey="&lightning.menupopup.open.calendar.accesskey;"
                  oncommand="openLocalCalendar();"/>
      </menupopup>
    </menu>
    <menuitem id="ltnSave"
              insertbefore="menu_saveAs"
              label="&event.menu.item.save.label;"
              accesskey="&event.menu.item.save.tab.accesskey;"
              key="save-key"
              command="cmd_save"/>
    <menuitem id="ltnSaveAndClose"
              insertafter="ltnSave"
              label="&event.menu.item.saveandclose.label;"
              accesskey="&event.menu.item.saveandclose.tab.accesskey;"
              command="cmd_accept"/>
  </menupopup>
  <menuitem id="openMessageFileMenuitem" hidden="true"/>

  <menupopup id="menu_NewPopup">
    <menuitem id="ltnNewEvent"
              label="&lightning.menupopup.new.event.label;"
              insertbefore="menu_newFolder"
              accesskey="&lightning.menupopup.new.event.accesskey;"
              key="calendar-new-event-key"
              command="calendar_new_event_command"/>
    <menuitem id="ltnNewTask"
              label="&lightning.menupopup.new.task.label;"
              insertbefore="menu_newFolder"
              accesskey="&lightning.menupopup.new.task.accesskey;"
              key="calendar-new-todo-key"
              command="calendar_new_todo_command"/>
    <menuseparator id="afterltnNewTask"
                   insertbefore="menu_newFolder"
                   observes="menu_newFolder"/>
    <menuitem id="ltnNewCalendar" label="&lightning.menupopup.new.calendar.label;"
               command="calendar_new_calendar_command"
               accesskey="&lightning.menupopup.new.calendar.accesskey;"
               insertafter="newAccountMenuItem"/>
  </menupopup>

  <menupopup id="menu_EditPopup">
    <menuitem id="ltnCalendarProperties"
              insertafter="menu_properties"
              label="&calendar.properties.label;"
              accesskey="&calendar.properties.accesskey;"
              command="calendar_edit_calendar_command"/>
  </menupopup>

  <menupopup id="menu_View_Popup">
    <menu id="menu_Toolbars"
          onpopupshowing="onToolbarsPopupShowingForTabType(event);"/>
    <menuseparator id="ltnViewMenuSeparator"
                   insertbefore="viewSortMenuSeparator"/>
    <menu id="ltnTodayPaneMenu"
          insertbefore="viewSortMenuSeparator"
          label="&calendar.context.button.label;"
          accesskey="&calendar.context.button.accesskey;">
      <menupopup id="ltnTodayPaneMenuPopup">
        <menuitem id="ltnShowTodayPane-2"
                  label="&todaypane.showTodayPane.label;"
                  accesskey="&todaypane.showTodayPane.accesskey;"
                  type="checkbox"
                  key="todaypanekey"
                  command="calendar_toggle_todaypane_command"/>
        <menuseparator id="ltnSeparatorBeforeDisplayMiniday"/>
        <menuitem id="ltnTodayPaneDisplayMiniday"
                  name="minidisplay"
                  value="miniday"
                  type="radio"
                  oncommand="TodayPane.displayMiniSection('miniday')"
                  label="&todaypane.showMiniday.label;"
                  accesskey="&todaypane.showMiniday.accesskey;"/>
        <menuitem id="ltnTodayPaneDisplayMinimonth"
                  name="minidisplay"
                  value="minimonth"
                  type="radio"
                  oncommand="TodayPane.displayMiniSection('minimonth')"
                  label="&todaypane.showMinimonth.label;"
                  accesskey="&todaypane.showMinimonth.accesskey;"/>
        <menuitem id="ltnTodayPaneDisplayNone"
                  name="minidisplay"
                  value="none"
                  type="radio"
                  oncommand="TodayPane.displayMiniSection('none')"
                  label="&todaypane.showNone.label;"
                  accesskey="&todaypane.showNone.accesskey;"/>
      </menupopup>
    </menu>
    <menu id="ltnCalendarMenu"
          observes="calendar_in_foreground"
          insertbefore="viewSortMenuSeparator"
          label="&lightning.menu.view.calendar.label;"
          accesskey="&lightning.menu.view.calendar.accesskey;">
      <menupopup id="ltnCalendarMenuPopup">
        <menuitem id="ltnChangeViewDay"
                  label="&lightning.toolbar.day.label;"
                  accesskey="&lightning.toolbar.day.accesskey;"
                  type="radio"
                  name="calendarMenuViews"
                  key="calendar-day-view-key"
                  command="calendar_day-view_command"/>
        <menuitem id="ltnChangeViewWeek"
                  label="&lightning.toolbar.week.label;"
                  accesskey="&lightning.toolbar.week.accesskey;"
                  type="radio"
                  name="calendarMenuViews"
                  key="calendar-week-view-key"
                  command="calendar_week-view_command"/>
        <menuitem id="ltnChangeViewMultiweek"
                  label="&lightning.toolbar.multiweek.label;"
                  accesskey="&lightning.toolbar.multiweek.accesskey;"
                  type="radio"
                  name="calendarMenuViews"
                  key="calendar-multiweek-view-key"
                  command="calendar_multiweek-view_command"/>
        <menuitem id="ltnChangeViewMonth"
                  label="&lightning.toolbar.month.label;"
                  accesskey="&lightning.toolbar.month.accesskey;"
                  type="radio"
                  name="calendarMenuViews"
                  key="calendar-month-view-key"
                  command="calendar_month-view_command"/>
        <menuseparator id="ltnBeforeCalendarViewSection"/>
        <menu id="ltnCalendarPaneMenu"
              label="&lightning.toolbar.calendarmenu.label;"
              accesskey="&lightning.toolbar.calendarmenu.accesskey;">
          <menupopup id="ltnCalendarPanePopup"
                     onpopupshowing="InitViewCalendarPaneMenu()">
            <menuitem id="ltnViewCalendarPane"
                      type="checkbox"
                      label="&lightning.toolbar.calendarpane.label;"
                      accesskey="&lightning.toolbar.calendarpane.accesskey;"
                      command="calendar_toggle_calendarsidebar_command"/>
            <menuseparator id="ltnCalendarPaneMenuSeparator"/>
            <menuitem id="ltnTasksViewMinimonth"
                      type="checkbox"
                      label="&calendar.tasks.view.minimonth.label;"
                      accesskey="&calendar.tasks.view.minimonth.accesskey;"
                      command="calendar_toggle_minimonthpane_command"/>
            <menuitem id="ltnTasksViewCalendarlist"
                      type="checkbox"
                      label="&calendar.tasks.view.calendarlist.label;"
                      accesskey="&calendar.tasks.view.calendarlist.accesskey;"
                      command="calendar_toggle_calendarlist_command"/>
          </menupopup>
        </menu>
        <menuseparator id="ltnBeforeCurrentViewMenu"/>
        <menu id="ltnCalendarCurrentViewMenu"
              observes="calendar_mode_calendar"
              label="&showCurrentView.label;"
              accesskey="&showCurrentView.accesskey;">
          <menupopup id="ltnCalendarCurrentViewMenuPopup">
            <menuitem type="checkbox"
                      id="ltnWorkdaysOnlyMenuitem"
                      label="&calendar.onlyworkday.checkbox.label;"
                      accesskey="&calendar.onlyworkday.checkbox.accesskey;"
                      command="calendar_toggle_workdays_only_command"/>
            <menuitem type="checkbox"
                      id="ltnTasksInViewMenuitem"
                      label="&calendar.displaytodos.checkbox.label;"
                      accesskey="&calendar.displaytodos.checkbox.accesskey;"
                      command="calendar_toggle_tasks_in_view_command"/>
            <menuitem type="checkbox"
                      id="ltnShowCompletedInViewMenuItem"
                      label="&calendar.completedtasks.checkbox.label;"
                      accesskey="&calendar.completedtasks.checkbox.accesskey;"
                      command="calendar_toggle_show_completed_in_view_command"/>
            <menuitem type="checkbox"
                      id="ltnViewRotated"
                      label="&calendar.orientation.label;"
                      accesskey="&calendar.orientation.accesskey;"
                      command="calendar_toggle_orientation_command"/>
          </menupopup>
        </menu>
      </menupopup>
    </menu>
    <menu id="ltnTasksMenu"
          observes="calendar_mode_task"
          insertbefore="viewSortMenuSeparator"
          label="&lightning.menu.view.tasks.label;"
          accesskey="&lightning.menu.view.tasks.accesskey;">
      <menupopup id="ltnTasksMenuPopup">
        <menuitem id="ltnTasksViewFilterTasks"
                  type="checkbox"
                  label="&calendar.tasks.view.filtertasks.label;"
                  accesskey="&calendar.tasks.view.filtertasks.accesskey;"
                  command="calendar_toggle_filter_command"/>
        <menuseparator id="ltnTasksViewSeparator"/>
        <menuitem id="ltnTasksViewFilterCurrent"
                  name="filtergroup"
                  value="throughcurrent"
                  type="radio"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.current.label;"
                  accesskey="&calendar.task.filter.current.accesskey;"/>
        <menuitem id="ltnTasksViewFilterToday"
                  name="filtergroup"
                  value="throughtoday"
                  type="radio"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.today.label;"
                  accesskey="&calendar.task.filter.today.accesskey;"/>
        <menuitem id="ltnTasksViewFilterNext7days"
                  name="filtergroup"
                  value="throughsevendays"
                  type="radio"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.next7days.label;"
                  accesskey="&calendar.task.filter.next7days.accesskey;"/>
        <menuitem id="ltnTasksViewFilterNotstartedtasks"
                  name="filtergroup"
                  value="notstarted"
                  type="radio"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.notstarted.label;"
                  accesskey="&calendar.task.filter.notstarted.accesskey;"/>
        <menuitem id="ltnTasksViewFilterOverdue"
                  name="filtergroup"
                  value="overdue"
                  type="radio"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.overdue.label;"
                  accesskey="&calendar.task.filter.overdue.accesskey;"/>
        <menuitem id="ltnTasksViewFilterCompleted"
                  name="filtergroup"
                  type="radio"
                  value="completed"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.completed.label;"
                  accesskey="&calendar.task.filter.completed.accesskey;"/>
        <menuitem id="ltnTasksViewFilterOpen"
                  name="filtergroup"
                  type="radio"
                  value="open"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.open.label;"
                  accesskey="&calendar.task.filter.open.accesskey;"/>
        <menuitem id="ltnTasksViewFilterAll"
                  name="filtergroup"
                  value="all"
                  type="radio"
                  command="calendar_task_filter_command"
                  label="&calendar.task.filter.all.label;"
                  accesskey="&calendar.task.filter.all.accesskey;"/>
      </menupopup>
    </menu>
  </menupopup>

  <menupopup id="menu_GoPopup">
    <menuitem id="ltnGoToToday"
              insertafter="goNextSeparator"
              label="&goTodayCmd.label;"
              accesskey="&goTodayCmd.accesskey;"
              command="calendar_go_to_today_command"
              key="calendar-go-to-today-key"/>
  </menupopup>

  <menupopup id="menu_GoNextPopup">
    <menuseparator id="ltnGoNextSeparator"/>
    <!-- Label is set up automatically using the view id. When writing a
         view extension, overlay this menuitem and add a label-<myviewtype>
         attribute with the correct label -->
    <menuitem id="calendar-go-menu-next"
              label=""
              label-day="&lightning.toolbar.day.label;"
              label-week="&lightning.toolbar.week.label;"
              label-multiweek="&lightning.toolbar.week.label;"
              label-month="&lightning.toolbar.month.label;"
              accesskey-day="&lightning.toolbar.day.accesskey;"
              accesskey-week="&lightning.toolbar.week.accesskey;"
              accesskey-multiweek="&lightning.toolbar.week.accesskey;"
              accesskey-month="&lightning.toolbar.month.accesskey;"
              command="calendar_view_next_command"/>
  </menupopup>

  <menupopup id="menu_GoPreviousPopup">
    <menuseparator id="ltnGoPreviousSeparator"/>
    <!-- Label is set up automatically using the view id. When writing a
         view extension, overlay this menuitem and add a label-<myviewtype>
         attribute with the correct label -->
    <menuitem id="calendar-go-menu-previous"
              label=""
              label-day="&lightning.toolbar.day.label;"
              label-week="&lightning.toolbar.week.label;"
              label-multiweek="&lightning.toolbar.week.label;"
              label-month="&lightning.toolbar.month.label;"
              accesskey-day="&lightning.toolbar.day.accesskey;"
              accesskey-week="&lightning.toolbar.week.accesskey;"
              accesskey-multiweek="&lightning.toolbar.week.accesskey;"
              accesskey-month="&lightning.toolbar.month.accesskey;"
              command="calendar_view_prev_command"/>
  </menupopup>

  <menubar id="mail-menubar">
    <menu id="menu_Event_Task"
          label="&lightning.menu.eventtask.label;"
          accesskey="&lightning.menu.eventtask.accesskey;"
          insertafter="messageMenu">
      <menupopup id="menu_Event_Task_Popup" onpopupshowing="changeMenuForTask(event); setupDeleteMenuitem('ltnDeleteSelectedCalendar')">
        <menuitem id="ltnNewEvent2"
                  label="&event.new.event;"
                  accesskey="&event.new.event.accesskey;"
                  key="calendar-new-event-key"
                  command="calendar_new_event_command"/>
        <menuitem id="ltnNewTask2"
                  label="&event.new.task;"
                  accesskey="&event.new.task.accesskey;"
                  key="calendar-new-todo-key"
                  command="calendar_new_todo_command"/>
        <menuseparator id="before-Calendar-Mode-Section"/>
        <menuitem id="ltnMenuSwitchToCalendar"
                  type="checkbox"
                  label="&lightning.toolbar.calendar.label;"
                  accesskey="&lightning.toolbar.calendar.accesskey;"
                  command="switch2calendar"
                  value="calendar"
                  key="openLightningKey"
                  autocheck="false">
        </menuitem>
        <menuitem id="ltnMenuSwitchToTask"
                  type="checkbox"
                  label="&lightning.toolbar.task.label;"
                  accesskey="&lightning.toolbar.task.accesskey;"
                  command="switch2task"
                  value="task"
                  key="openTasksKey"
                  autocheck="false">
        </menuitem>
        <menuseparator id="ltnBeforeCalendarSection"/>
        <menuitem id="ltnExportCalendar"
                  label="&calendar.export.label;"
                  accesskey="&calendar.export.accesskey;"
                  command="calendar_export_command"/>
        <menuitem id="ltnImportCalendar"
                  label="&calendar.import.label;"
                  accesskey="&calendar.import.accesskey;"
                  command="calendar_import_command"/>
        <menuitem id="ltnPublishCalendar"
                  label="&calendar.publish.label;"
                  accesskey="&calendar.publish.accesskey;"
                  command="calendar_publish_calendar_command"/>
        <menuitem id="ltnDeleteSelectedCalendar"
                  labeldelete="&calendar.deletecalendar.label;"
                  labelremove="&calendar.removecalendar.label;"
                  labelunsubscribe="&calendar.unsubscribecalendar.label;"
                  accesskeydelete="&calendar.deletecalendar.accesskey;"
                  accesskeyremove="&calendar.removecalendar.accesskey;"
                  accesskeyunsubscribe="&calendar.unsubscribecalendar.accesskey;"
                  command="calendar_delete_calendar_command"/>
        <menuseparator id="ltnBeforeTaskActions"/>
        <menuitem id="ltnTaskActionsMarkCompletedMenuitem"
                  type="checkbox"
                  label="&calendar.context.markcompleted.label;"
                  accesskey="&calendar.context.markcompleted.accesskey;"
                  command="calendar_toggle_completed_command"/>
        <menu id="ltnTaskActionsPriorityMenuitem"
              label="&calendar.context.priority.label;"
              accesskey="&calendar.context.priority.accesskey;"
              command="calendar_general-priority_command">
          <menupopup is="calendar-task-priority-menupopup"/>
        </menu>
        <menu id="ltnTaskActionsProgressMenuitem"
              label="&calendar.context.progress.label;"
              accesskey="&calendar.context.progress.accesskey;"
              command="calendar_general-progress_command">
          <menupopup is="calendar-task-progress-menupopup"/>
        </menu>
        <menu id="ltnTaskActionsPostponeMenuitem"
              label="&calendar.context.postpone.label;"
              accesskey="&calendar.context.postpone.accesskey;"
              command="calendar_general-postpone_command">
          <menupopup id="ltnTaskActionsPostponeMenuPopup">
            <menuitem id="ltnTaskActionsPostponeMenu-1hour"
                      label="&calendar.context.postpone.1hour.label;"
                      accesskey="&calendar.context.postpone.1hour.accesskey;"
                      command="calendar_postpone-1hour_command"/>
            <menuitem id="ltnTaskActionsPostponeMenu-1day"
                      label="&calendar.context.postpone.1day.label;"
                      accesskey="&calendar.context.postpone.1day.accesskey;"
                      command="calendar_postpone-1day_command"/>
            <menuitem id="ltnTaskActionsPostponeMenu-1week"
                      label="&calendar.context.postpone.1week.label;"
                      accesskey="&calendar.context.postpone.1week.accesskey;"
                      command="calendar_postpone-1week_command"/>
          </menupopup>
        </menu>
        <menuseparator id="ltnBeforeUnifinderSection" />
        <menuitem id="ltnShowUnifinder"
                  type="checkbox"
                  checked="true"
                  label="&showUnifinderCmd.label;"
                  accesskey="&showUnifinderCmd.accesskey;"
                  command="calendar_show_unifinder_command"/>
      </menupopup>
    </menu>
  </menubar>

  <menupopup id="mailContext">
    <menu id="mailContext-calendar-convert-menu"
          insertafter="mailContext-moveToFolderAgain"
          label="&calendar.context.convertmenu.label;"
          accesskey="&calendar.context.convertmenu.accesskey.mail;">
      <menupopup id="mailContext-calendar-convert-menupopup">
        <menuitem id="mailContext-calendar-convert-event-menuitem"
                  label="&calendar.context.convertmenu.event.label;"
                  accesskey="&calendar.context.convertmenu.event.accesskey;"
                  oncommand="calendarExtract.extractFromEmail(true)" />
        <menuitem id="mailContext-calendar-convert-task-menuitem"
                  label="&calendar.context.convertmenu.task.label;"
                  accesskey="&calendar.context.convertmenu.task.accesskey;"
                  oncommand="calendarExtract.extractFromEmail(false)" />
      </menupopup>
    </menu>
  </menupopup>

  <menupopup id="otherActionsPopup">
    <menu id="otherActions-calendar-convert-menu"
          label="&calendar.context.convertmenu.label;"
          accesskey="&calendar.context.convertmenu.accesskey.mail;">
      <menupopup id="otherActions-calendar-convert-menupopup">
        <menuitem id="otherActions-calendar-convert-event-menuitem"
                  label="&calendar.context.convertmenu.event.label;"
                  accesskey="&calendar.context.convertmenu.event.accesskey;"
                  oncommand="calendarExtract.extractFromEmail(true)" />
        <menuitem id="otherActions-calendar-convert-task-menuitem"
                  label="&calendar.context.convertmenu.task.label;"
                  accesskey="&calendar.context.convertmenu.task.accesskey;"
                  oncommand="calendarExtract.extractFromEmail(false)" />
      </menupopup>
    </menu>
  </menupopup>

  <menupopup id="toolbar-context-menu"
             onpopupshowing="onToolbarsPopupShowingForTabType(event);"/>

  <!-- App Menu Integration -->
  <!-- Calendar menu items added to appmenu menus -->

  <!-- Main Appmenu View -->
  <vbox id="appMenu-mainViewItems">
    <toolbarbutton id="appmenu_Event_Task"
                   class="subviewbutton subviewbutton-nav"
                   label="&lightning.menu.eventtask.label;"
                   insertafter="appmenu_messageMenu"
                   closemenu="none"
                   oncommand="PanelUI.showSubView('appmenu_Event_Task_View', this)"/>
  </vbox>

  <!-- New -->
  <vbox id="appMenu-newViewItems">
    <toolbarbutton id="appmenu_ltnNewEvent"
                   class="subviewbutton subviewbutton-iconic"
                   label="&lightning.menupopup.new.event.label;"
                   insertbefore="appmenu_newFolder"
                   command="calendar_new_event_command"/>
    <toolbarbutton id="appmenu_ltnNewTask"
                   class="subviewbutton subviewbutton-iconic"
                   label="&lightning.menupopup.new.task.label;"
                   insertbefore="appmenu_newFolder"
                   command="calendar_new_todo_command"/>
    <toolbarseparator id="appmenu_afterltnNewTask"
                      insertbefore="appmenu_newFolder"
                      observes="appmenu_newFolder"/>
    <toolbarbutton id="appmenu_ltnNewCalendar"
                   class="subviewbutton subviewbutton-iconic"
                   label="&lightning.menupopup.new.calendar.label;"
                   command="calendar_new_calendar_command"
                   insertafter="appmenu_newAccountMenuItem"/>
  </vbox>

  <!-- File -->
  <vbox id="appMenu-fileViewItems">
    <toolbarbutton id="appmenu_Open"
                   class="subviewbutton subviewbutton-nav"
                   mode="calendar"
                   label="&lightning.menupopup.open.label;"
                   closemenu="none"
                   accesskey="&lightning.menupopup.open.accesskey;"
                   insertbefore="appmenu_openMessageFileMenuitem"
                   oncommand="PanelUI.showSubView('appMenu-fileOpenView', this)"/>
  </vbox>
  <toolbarbutton id="appmenu_openMessageFileMenuitem"
                 hidden="true"/>

  <!-- View -->
  <vbox id="appMenu-viewViewItems">
    <toolbarseparator id="appmenu_ltnViewMenuSeparator"/>
    <toolbarbutton id="appmenu_ltnTodayPaneMenu"
                   class="subviewbutton subviewbutton-nav"
                   label="&calendar.context.button.label;"
                   closemenu="none"
                   oncommand="PanelUI.showSubView('appmenu_ltnTodayPaneView', this)"/>
    <toolbarbutton id="appmenu_ltnCalendarMenu"
                   class="subviewbutton subviewbutton-nav"
                   observes="calendar_in_foreground"
                   insertbefore="viewSortMenuSeparator"
                   label="&lightning.menu.view.calendar.label;"
                   closemenu="none"
                   oncommand="PanelUI.showSubView('appmenu_ltnCalendarMenuView', this)"/>
    <toolbarbutton id="appmenu_ltnTasksMenu"
                   class="subviewbutton subviewbutton-nav"
                   observes="calendar_mode_task"
                   insertbefore="viewSortMenuSeparator"
                   label="&lightning.menu.view.tasks.label;"
                   closemenu="none"
                   oncommand="PanelUI.showSubView('appmenu_ltnTasksView', this)"/>
  </vbox>

  <!-- Go -->
  <vbox id="appMenu-goViewItems">
    <toolbarbutton id="appmenu_ltnGoToToday"
                   class="subviewbutton subviewbutton-iconic"
                   insertafter="appmenu_goNextSeparator"
                   label="&goTodayCmd.label;"
                   command="calendar_go_to_today_command"/>
  </vbox>

  <!-- Go / Next -->
  <vbox id="appMenu-goNextViewItems">
    <toolbarseparator id="appmenu_ltnGoNextSeparator"/>
    <!-- Label is set up automatically using the view id. When writing a
         view extension, overlay this toolbarbutton and add a label-<myviewtype>
         attribute with the correct label -->
    <toolbarbutton id="appmenu_calendar-go-menu-next"
                   class="subviewbutton subviewbutton-iconic"
                   label=""
                   label-day="&lightning.toolbar.day.label;"
                   label-week="&lightning.toolbar.week.label;"
                   label-multiweek="&lightning.toolbar.week.label;"
                   label-month="&lightning.toolbar.month.label;"
                   command="calendar_view_next_command"/>
  </vbox>

  <!-- Go / Previous -->
  <vbox id="appMenu-goPreviousViewItems">
    <toolbarseparator id="appmenu_ltnGoPreviousSeparator"/>
    <!-- Label is set up automatically using the view id. When writing a
         view extension, overlay this menuitem and add a label-<myviewtype>
         attribute with the correct label -->
    <toolbarbutton id="appmenu_calendar-go-menu-previous"
                   class="subviewbutton subviewbutton-iconic"
                   label=""
                   label-day="&lightning.toolbar.day.label;"
                   label-week="&lightning.toolbar.week.label;"
                   label-multiweek="&lightning.toolbar.week.label;"
                   label-month="&lightning.toolbar.month.label;"
                   command="calendar_view_prev_command"/>
  </vbox>

  <!-- Calendar submenus added to the appmenu -->
  <panelmultiview id="appMenu-multiView">

    <!-- Events and Tasks -->
    <panelview id="appmenu_Event_Task_View"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_ltnMenuSwitchToCalendar"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&lightning.toolbar.calendar.label;"
                       command="switch2calendar"
                       value="calendar"
                       autocheck="false">
        </toolbarbutton>
        <toolbarbutton id="appmenu_ltnMenuSwitchToTask"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&lightning.toolbar.task.label;"
                       command="switch2task"
                       value="task"
                       autocheck="false">
        </toolbarbutton>
        <toolbarseparator id="appmenu_ltnBeforeCalendarSection"/>
        <toolbarbutton id="appmenu_ltnExportCalendar"
                       class="subviewbutton subviewbutton-iconic"
                       label="&calendar.export.label;"
                       command="calendar_export_command"/>
        <toolbarbutton id="appmenu_ltnImportCalendar"
                       class="subviewbutton subviewbutton-iconic"
                       label="&calendar.import.label;"
                       command="calendar_import_command"/>
        <toolbarbutton id="appmenu_ltnPublishCalendar"
                       class="subviewbutton subviewbutton-iconic"
                       label="&calendar.publish.label;"
                       command="calendar_publish_calendar_command"/>
        <toolbarbutton id="appmenu_ltnDeleteSelectedCalendar"
                       class="subviewbutton subviewbutton-iconic"
                       labeldelete="&calendar.deletecalendar.label;"
                       labelremove="&calendar.removecalendar.label;"
                       labelunsubscribe="&calendar.unsubscribecalendar.label;"
                       accesskeydelete="&calendar.deletecalendar.accesskey;"
                       accesskeyremove="&calendar.removecalendar.accesskey;"
                       accesskeyunsubscribe="&calendar.unsubscribecalendar.accesskey;"
                       command="calendar_delete_calendar_command"/>
        <toolbarseparator id="ltnBeforeTaskActions"/>
        <toolbarbutton id="appmenu_ltnTaskActionsMarkCompletedMenuitem"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.context.markcompleted.label;"
                       command="calendar_toggle_completed_command"/>
        <toolbarbutton id="appmenu_ltnTaskActionsPriorityMenuitem"
                       class="subviewbutton subviewbutton-nav"
                       label="&calendar.context.priority.label;"
                       closemenu="none"
                       oncommand="PanelUI.showSubView('appmenu_ltnTaskPriorityView', this)"/>
        <toolbarbutton id="appmenu_ltnTaskActionsProgressMenuitem"
                       class="subviewbutton subviewbutton-nav"
                       label="&calendar.context.progress.label;"
                       closemenu="none"
                       oncommand="PanelUI.showSubView('appmenu_ltnTaskProgressView', this)"/>
        <toolbarbutton id="appmenu_ltnTaskActionsPostponeMenuitem"
                       class="subviewbutton subviewbutton-nav"
                       label="&calendar.context.postpone.label;"
                       observes="calendar_general-postpone_command"
                       closemenu="none"
                       oncommand="PanelUI.showSubView('appmenu_ltnTaskActionsPostponeView', this)"/>
        <toolbarseparator id="appmenu_ltnBeforeUnifinderSection" />
        <toolbarbutton id="appmenu_ltnShowUnifinder"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       checked="true"
                       label="&showUnifinderCmd.label;"
                       command="calendar_show_unifinder_command"/>
        <toolbarseparator id="appmenu_ltnBeforeCalendarProperties" />
        <toolbarbutton id="appmenu_ltnCalendarProperties"
                       class="subviewbutton subviewbutton-iconic"
                       insertafter="menu_properties"
                       label="&calendar.properties.label;"
                       command="calendar_edit_calendar_command"/>
      </vbox>
    </panelview>

    <!-- Events and Tasks / Priority -->
    <panelview is="calendar-task-priority-panelview" id="appmenu_ltnTaskPriorityView"
               class="PanelUI-subView"/>

    <!-- Events and Tasks / Progress -->
    <panelview is="calendar-task-progress-panelview" id="appmenu_ltnTaskProgressView"
               class="PanelUI-subView"/>

    <!-- Events and Tasks / Postpone Task -->
    <panelview id="appmenu_ltnTaskActionsPostponeView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="ltnTaskActionsPostponeMenu-1hour"
                       class="subviewbutton subviewbutton-iconic"
                       label="&calendar.context.postpone.1hour.label;"
                       command="calendar_postpone-1hour_command"/>
        <toolbarbutton id="appmenu_ltnTaskActionsPostponeMenu-1day"
                       class="subviewbutton subviewbutton-iconic"
                       label="&calendar.context.postpone.1day.label;"
                       command="calendar_postpone-1day_command"/>
        <toolbarbutton id="appmenu_ltnTaskActionsPostponeMenu-1week"
                       class="subviewbutton subviewbutton-iconic"
                       label="&calendar.context.postpone.1week.label;"
                       command="calendar_postpone-1week_command"/>
      </vbox>
    </panelview>

    <!-- File / Open -->
    <panelview id="appMenu-fileOpenView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_OpenMessageFileMenuitem"
                       class="subviewbutton subviewbutton-iconic"
                       label="&lightning.menupopup.open.message.label;"
                       accesskey="&lightning.menupopup.open.message.accesskey;"
                       oncommand="MsgOpenFromFile();"/>
        <toolbarbutton id="appmenu_OpenCalendarFileMenuitem"
                       class="subviewbutton subviewbutton-iconic"
                       label="&lightning.menupopup.open.calendar.label;"
                       accesskey="&lightning.menupopup.open.calendar.accesskey;"
                       oncommand="openLocalCalendar();"/>
      </vbox>
    </panelview>

    <!-- View / Today Pane -->
    <panelview id="appmenu_ltnTodayPaneView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_ltnShowTodayPane-2"
                       class="subviewbutton subviewbutton-iconic"
                       label="&todaypane.showTodayPane.label;"
                       type="checkbox"
                       command="calendar_toggle_todaypane_command"/>
        <toolbarseparator id="appmenu_ltnSeparatorBeforeDisplayMiniday"/>
        <toolbarbutton id="appmenu_ltnTodayPaneDisplayMiniday"
                       class="subviewbutton subviewbutton-iconic"
                       name="minidisplay"
                       value="miniday"
                       type="radio"
                       oncommand="TodayPane.displayMiniSection('miniday')"
                       observes="ltnTodayPaneDisplayMiniday"
                       label="&todaypane.showMiniday.label;"/>
        <toolbarbutton id="appmenu_ltnTodayPaneDisplayMinimonth"
                       class="subviewbutton subviewbutton-iconic"
                       name="minidisplay"
                       value="minimonth"
                       type="radio"
                       oncommand="TodayPane.displayMiniSection('minimonth')"
                       observes="ltnTodayPaneDisplayMinimonth"
                       label="&todaypane.showMinimonth.label;"/>
        <toolbarbutton id="appmenu_ltnTodayPaneDisplayNone"
                       class="subviewbutton subviewbutton-iconic"
                       name="minidisplay"
                       value="none"
                       type="radio"
                       oncommand="TodayPane.displayMiniSection('none')"
                       observes="ltnTodayPaneDisplayNone"
                       label="&todaypane.showNone.label;"/>
      </vbox>
    </panelview>

    <!-- View / Calendar -->
    <panelview id="appmenu_ltnCalendarMenuView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_ltnChangeViewDay"
                       class="subviewbutton subviewbutton-iconic"
                       label="&lightning.toolbar.day.label;"
                       type="radio"
                       name="calendarMenuViews"
                       command="calendar_day-view_command"/>
        <toolbarbutton id="appmenu_ltnChangeViewWeek"
                       class="subviewbutton subviewbutton-iconic"
                       label="&lightning.toolbar.week.label;"
                       type="radio"
                       name="calendarMenuViews"
                       command="calendar_week-view_command"/>
        <toolbarbutton id="appmenu_ltnChangeViewMultiweek"
                       class="subviewbutton subviewbutton-iconic"
                       label="&lightning.toolbar.multiweek.label;"
                       type="radio"
                       name="calendarMenuViews"
                       command="calendar_multiweek-view_command"/>
        <toolbarbutton id="appmenu_ltnChangeViewMonth"
                       class="subviewbutton subviewbutton-iconic"
                       label="&lightning.toolbar.month.label;"
                       type="radio"
                       name="calendarMenuViews"
                       command="calendar_month-view_command"/>
        <toolbarseparator id="appmenu_ltnBeforeCalendarViewSection"/>
        <toolbarbutton id="appmenu_ltnCalendarPaneMenu"
                       class="subviewbutton subviewbutton-nav"
                       label="&lightning.toolbar.calendarmenu.label;"
                       closemenu="none"
                       oncommand="PanelUI.showSubView('appmenu_ltnCalendarPaneView', this)"/>
        <toolbarseparator id="appmenu_ltnBeforeCurrentViewMenu"/>
        <toolbarbutton id="appmenu_ltnCalendarCurrentViewMenu"
                       class="subviewbutton subviewbutton-nav"
                       observes="calendar_mode_calendar"
                       label="&showCurrentView.label;"
                       closemenu="none"
                       oncommand="PanelUI.showSubView('appmenu_ltnCalendarCurrentViewView', this)"/>
      </vbox>
    </panelview>

    <!-- View / Calendar / Calendar Pane -->
    <panelview id="appmenu_ltnCalendarPaneView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_ltnViewCalendarPane"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&lightning.toolbar.calendarpane.label;"
                       command="calendar_toggle_calendarsidebar_command"/>
        <toolbarseparator id="appmenu_ltnCalendarPaneMenuSeparator"/>
        <toolbarbutton id="appmenu_ltnTasksViewMinimonth"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.tasks.view.minimonth.label;"
                       command="calendar_toggle_minimonthpane_command"/>
        <toolbarbutton id="appmenu_ltnTasksViewCalendarlist"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.tasks.view.calendarlist.label;"
                       command="calendar_toggle_calendarlist_command"/>
      </vbox>
    </panelview>

    <!-- View / Calendar / Current View -->
    <panelview id="appmenu_ltnCalendarCurrentViewView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_ltnWorkdaysOnlyMenuitem"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.onlyworkday.checkbox.label;"
                       command="calendar_toggle_workdays_only_command"/>
        <toolbarbutton id="appmenu_ltnTasksInViewMenuitem"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.displaytodos.checkbox.label;"
                       command="calendar_toggle_tasks_in_view_command"/>
        <toolbarbutton id="appmenu_ltnShowCompletedInViewMenuItem"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.completedtasks.checkbox.label;"
                       command="calendar_toggle_show_completed_in_view_command"/>
        <toolbarbutton id="appmenu_ltnViewRotated"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.orientation.label;"
                       command="calendar_toggle_orientation_command"/>
      </vbox>
    </panelview>

    <!-- View / Tasks -->
    <panelview id="appmenu_ltnTasksView"
               class="PanelUI-subView">
      <vbox class="panel-subview-body">
        <toolbarbutton id="appmenu_ltnTasksViewFilterTasks"
                       class="subviewbutton subviewbutton-iconic"
                       type="checkbox"
                       label="&calendar.tasks.view.filtertasks.label;"
                       command="calendar_toggle_filter_command"/>
        <toolbarseparator id="appmenu_ltnTasksViewSeparator"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterCurrent"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       value="throughcurrent"
                       type="radio"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.current.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterToday"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       value="throughtoday"
                       type="radio"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.today.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterNext7days"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       value="throughsevendays"
                       type="radio"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.next7days.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterNotstartedtasks"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       value="notstarted"
                       type="radio"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.notstarted.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterOverdue"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       value="overdue"
                       type="radio"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.overdue.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterCompleted"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       type="radio"
                       value="completed"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.completed.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterOpen"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       type="radio"
                       value="open"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.open.label;"/>
        <toolbarbutton id="appmenu_ltnTasksViewFilterAll"
                       class="subviewbutton subviewbutton-iconic"
                       name="filtergroup"
                       value="all"
                       type="radio"
                       command="calendar_task_filter_command"
                       label="&calendar.task.filter.all.label;"/>
      </vbox>
    </panelview>

  </panelmultiview>
</overlay>
